{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Automatizaci\u00f3n Industrial | Documentaci\u00f3n sobre TC3","text":"<p>Sugerencia</p> <p>Usa el men\u00fa lateral y el buscador para moverte r\u00e1pido.</p>"},{"location":"#bienvenida","title":"Bienvenida","text":"<p>Bienvenido/a al cuaderno de pr\u00e1cticas. Aqu\u00ed encontrar\u00e1s gu\u00edas y material de apoyo para trabajar con TwinCAT 3.</p> <p>Archivo de documentaci\u00f3n que contiene conceptos te\u00f3ricos y fundamentales relacionados con el proyecto. Incluye definiciones, explicaciones de principios clave, y gu\u00edas de referencia para entender la arquitectura y los componentes principales del sistema.</p> <p>Archivo README que proporciona instrucciones de demostraci\u00f3n y uso espec\u00edfico para el componente o m\u00f3dulo TC3. Contiene gu\u00edas de instalaci\u00f3n, ejemplos pr\u00e1cticos de ejecuci\u00f3n, requisitos previos, y pasos paso a paso para ejecutar la demostraci\u00f3n del TC3.</p>"},{"location":"#contenidos","title":"Contenidos","text":"<ul> <li>Beckhoff y TwinCAT 3</li> <li>TwinCAT 3 Conceptos Generales</li> <li>TwinCAT 3 Demo</li> </ul>"},{"location":"contenidos/00_presentacion/","title":"Beckhoff","text":""},{"location":"contenidos/00_presentacion/#la-empresa","title":"La Empresa","text":"<p>Beckhoff Automation GmbH &amp; Co. es un fabricante de tecnolog\u00eda de automatizaci\u00f3n con sede en Verl, en Renania del Norte-Westfalia (Alemania), y forma parte del Grupo Beckhoff. Fundada por Hans Beckhoff en 1980, la empresa implementa sistemas de automatizaci\u00f3n para la industria y la automatizaci\u00f3n de edificios.</p> <p>Su caracter\u00edstica esencial se materializ\u00f3 con el lanzamiento en 1986 del primer controlador industrial basado en PC del mercado. Esta fue una idea radical en aquel entonces: utilizar la potencia y flexibilidad de un ordenador est\u00e1ndar, en lugar de los sistemas de control propietarios y cerrados que dominaban la industria. Este concepto, que llamaron \"PC-based Control\" (control basado en PC), se convertir\u00eda en la piedra angular de la empresa y en una revoluci\u00f3n silenciosa para la automatizaci\u00f3n.</p> <p>Adem\u00e1s del uso de la tecnolog\u00eda de control basada en PC, desarrollada sobre la base de est\u00e1ndares abiertos, Beckhoff protagoniz\u00f3 en 2003 otro hito que revolucion\u00f3 las comunicaciones industriales: el desarrollo de EtherCAT (Ethernet for Control Automation Technology). Se trata de un bus de campo industrial en tiempo real basado en Ethernet, extremadamente r\u00e1pido y preciso, que desde entonces se ha convertido en un est\u00e1ndar mundial para la automatizaci\u00f3n de alto rendimiento, gestionado por un consorcio internacional del que forman parte miles de empresas.</p> <p>Manteniendo su esp\u00edritu pionero, Beckhoff ha continuado ampliando los l\u00edmites de la tecnolog\u00eda con sistemas extraordinarios:</p> <ul> <li>XTS (2011): XTS (eXtended Transportation System), un sistema de transporte lineal con m\u00faltiples motores independientes (movers) que permiten un movimiento altamente din\u00e1mico y flexible en una sola pista.</li> <li>XPlanar (2018): Sistema de transporte planar que hace levitar y mover libremente productos sobre un mosaico de m\u00f3dulos, ofreciendo una flexibilidad sin precedentes.</li> <li>MX-System (2024-2025): Sistema que elimina la necesidad de armarios de control, integrando toda la electr\u00f3nica y la fuente de alimentaci\u00f3n en m\u00f3dulos robustos y resistentes, dise\u00f1ados para ser montados directamente en la m\u00e1quina.</li> </ul>"},{"location":"contenidos/00_presentacion/#interes-didactico","title":"Inter\u00e9s Did\u00e1ctico","text":"<p>Desde un punto de vista did\u00e1ctico, Beckhoff presenta un ecosistema especialmente atractivo para su uso en entornos educativos y de formaci\u00f3n. Esta idoneidad se sustenta en tres pilares fundamentales que, en conjunto, suponen una clara ventaja frente a otras filosof\u00edas de automatizaci\u00f3n:</p> <ol> <li>Compromiso con los est\u00e1ndares abiertos: A diferencia de los ecosistemas cerrados y propietarios que a\u00fan persisten en la industria, Beckhoff basa su tecnolog\u00eda en est\u00e1ndares internacionales. Esto no solo garantiza la interoperabilidad con otros sistemas, sino que permite al alumnado adquirir conocimientos y competencias universales, transferibles a m\u00faltiples entornos tecnol\u00f3gicos, en lugar de limitarse a aprender a manejar un \u00fanico fabricante.</li> <li>Acceso sin barreras para el aprendizaje (Pol\u00edtica de licencias): Su modelo de negocio permite a estudiantes, investigadores y desarrolladores trabajar con el entorno TwinCAT de forma completamente gratuita durante la fase de desarrollo y aprendizaje. El entorno de programaci\u00f3n puede descargarse y ejecutarse sin ning\u00fan coste, eliminando la barrera econ\u00f3mica que imponen otros fabricantes con licencias muy costosas, incluso para fines acad\u00e9micos.</li> <li>Entorno de simulaci\u00f3n integrado: La posibilidad de ejecutar, depurar y validar c\u00f3digo de control de manera virtual es clave en la docencia. Beckhoff permite probar proyectos completos de automatismo utilizando \u00fanicamente un PC, sin necesidad de disponer de hardware f\u00edsico. Su potente emulador (Runtime) y simulador (UmRT_Default) integrados replican fielmente el comportamiento de los sistemas reales, facilitando la experimentaci\u00f3n, el autoaprendizaje y la comprensi\u00f3n de conceptos complejos de una manera pr\u00e1ctica, segura y accesible desde cualquier lugar.</li> </ol>"},{"location":"contenidos/00_presentacion/#twincat-2","title":"TwinCAT 2","text":"<p>En 1996, Beckhoff present\u00f3 su plataforma software, TwinCAT (The Windows Control and Automation Technology). TwinCAT es un completo paquete para la automatizaci\u00f3n que incluye un software de desarrollo de aplicaciones para PLC y control num\u00e9rico (CNC) y un Runtime, que convert\u00eda cualquier PC industrial en un potente controlador l\u00f3gico programable (PLC) y controlador de movimientos en tiempo real. De esta forma, integraba la l\u00f3gica de control con el mundo de la inform\u00e1tica, permitiendo ejecutar c\u00f3digo TwinCAT en tiempo real en cualquier ordenador con Windows y sentando las bases para el concepto de \u00abControl Basado en PC\u00bb.</p>"},{"location":"contenidos/00_presentacion/#componentes-principales","title":"Componentes Principales","text":"<p>La arquitectura de TwinCAT 2 se articula en torno a tres aplicaciones clave que trabajan de forma conjunta:</p> <ul> <li>PLC Control: Es el Entorno Integrado de Desarrollo (IDE) para la creaci\u00f3n de programas de control. Soporta la totalidad de los lenguajes definidos en el est\u00e1ndar internacional IEC 61131-3 (Texto Estructurado, Diagrama de Contactos, Diagrama de Funciones, etc.), ofreciendo un entorno completo para la programaci\u00f3n, depuraci\u00f3n y compilaci\u00f3n del c\u00f3digo de la aplicaci\u00f3n.</li> <li>System Manager: Es la herramienta de configuraci\u00f3n del sistema TwinCAT que permite la conexi\u00f3n (asociaci\u00f3n o vinculaci\u00f3n) de las variables de entradas y salidas de las tareas software con las se\u00f1ales f\u00edsicas presentes en los buses de campo.</li> <li>Runtime: Es una aplicaci\u00f3n inform\u00e1tica que emula el comportamiento de un aut\u00f3mata programable industrial (SoftPLC) en un ordenador con Windows. El Runtime se encarga de ejecutar el ciclo b\u00e1sico de funcionamiento del programa de usuario, gestionar las comunicaciones en tiempo real y actualizar el estado de las entradas y salidas. Por esta raz\u00f3n, cualquier PC embebido de Beckhoff se suministra habitualmente con un Runtime preinstalado, convirti\u00e9ndolo de facto en un PLC industrial listo para ejecutar c\u00f3digo IEC 61131-3.</li> </ul>"},{"location":"contenidos/00_presentacion/#versiones","title":"Versiones","text":"<p>TwinCAT 2 es un software propietario que actualmente se distribuye en dos paquetes principales:</p> <ul> <li>Versi\u00f3n R3: Este paquete est\u00e1 destinado a sistemas con Windows de 32 bits. Incluye tanto el entorno de desarrollo completo como el Runtime. El entorno de desarrollo puede usarse de forma gratuita, indefinida y con toda su funcionalidad. El Runtime, por su parte, dispone de una licencia gratuita limitada a 30 d\u00edas, que puede renovarse de forma indefinida con la simple reinstalaci\u00f3n del paquete.</li> <li>Versi\u00f3n x64 Engineering: Dise\u00f1ada para sistemas operativos Windows de 64 bits, contiene \u00fanicamente el entorno de desarrollo de TwinCAT 2, que al igual que en la versi\u00f3n R3, puede usarse de forma gratuita, indefinida y con toda su funcionalidad.</li> </ul>"},{"location":"contenidos/00_presentacion/#twincat-3","title":"TwinCAT 3","text":"<p>TwinCAT 3 es la evoluci\u00f3n del sistema de programaci\u00f3n de Beckhoff, puesto a disposici\u00f3n del gran p\u00fablico a partir de 2012. Al igual que su predecesor, es un completo paquete para la automatizaci\u00f3n que incluye un software de desarrollo de aplicaciones para PLC y control num\u00e9rico y un Runtime que permite ejecutar en tiempo real c\u00f3digo TwinCAT en cualquier ordenador con Windows.</p> <p>TwinCAT 3 representa la evoluci\u00f3n del concepto de SoftPLC hacia la eXtended Automation (XA). A diferencia de TwinCAT 2, no es una aplicaci\u00f3n independiente, sino que se integra como una extensi\u00f3n dentro de Microsoft Visual Studio, convirti\u00e9ndolo en un entorno de desarrollo (IDE) de primer orden.</p> <p>En TwinCAT 3, las funciones que antes estaban separadas en diferentes aplicaciones (System Manager y PLC Control) se fusionan en una \u00fanica herramienta integrada:</p> <ul> <li>Engineering (XAE): Es el entorno de configuraci\u00f3n y programaci\u00f3n. Puede integrarse en Visual Studio o en su versi\u00f3n aislada TcXaeShell, disfrutando de todas las prestaciones que ofrece un IDE profesional (depuraci\u00f3n, control de versiones, etc.). TcXaeShell es una versi\u00f3n personalizada por Beckhoff del Shell de Visual Studio 2017.</li> <li>Runtime (XAR): Es el motor de ejecuci\u00f3n en tiempo real. Se ejecuta en modo kernel, lo que le permite tomar el control de uno o varios n\u00facleos del procesador (Multi-core) para garantizar que las tareas de automatizaci\u00f3n se ejecuten con determinismo, independientemente de la carga de trabajo de Windows.</li> </ul> <p>Los componentes principales del IDE son:</p> <ul> <li>Configuraci\u00f3n de Sistema (System): Donde se gestiona el hardware, la asignaci\u00f3n de n\u00facleos del procesador y las tareas (tasks).</li> <li>Configuraci\u00f3n de I/O: Sustituye al antiguo System Manager. Aqu\u00ed se escanean los buses de campo (siendo EtherCAT el est\u00e1ndar nativo) y se vinculan (mapean) las variables del PLC con las se\u00f1ales f\u00edsicas.</li> <li>PLC: Entorno de programaci\u00f3n basado en la norma IEC 61131-3. En TwinCAT 3, se introducen de lleno la Programaci\u00f3n Orientada a Objetos (POO) y el uso de Texto Estructurado (ST) como lenguaje principal.</li> </ul> <p>A diferencia de TwinCAT 2, cuyo Runtime s\u00f3lo funciona en sistemas de 32 bits, TwinCAT 3 est\u00e1 dise\u00f1ado para arquitecturas modernas de 64 bits. Adem\u00e1s del tradicional emulador (Runtime), dispone de un simulador (UmRT_Default) capaz de procesar c\u00f3digo IEC, aunque sin las prestaciones de tiempo real del emulador.</p>"},{"location":"contenidos/00_presentacion/#modelo-de-licencias","title":"Modelo de Licencias","text":"<p>Uno de los grandes \u00e9xitos de TwinCAT 3 es su modelo de licencias, especialmente atractivo para el \u00e1mbito acad\u00e9mico y de ingenier\u00eda:</p> <ul> <li>Instalaci\u00f3n Gratuita: El entorno de desarrollo (XAE) es completamente gratuito y se puede instalar en cualquier PC para programar y configurar proyectos de forma indefinida.</li> <li>Licencias de Prueba (Trial de 7 d\u00edas): TC3 permite generar licencias temporales de 7 d\u00edas para todas sus funciones (PLC, HMI, Motion, Safety, Vision). Estas licencias se pueden renovar de forma infinita simplemente introduciendo un c\u00f3digo \"Captcha\".</li> <li>Licencias Hardware: Para entornos de producci\u00f3n, las licencias se adquieren de forma permanente y se vinculan al hardware (el PC embebido o un dongle USB).</li> </ul>"},{"location":"contenidos/01_conceptos/","title":"\u2714 Conceptos generales","text":"Leyenda Abrev. Significado CD Clic derecho del rat\u00f3n CI Clic izquierdo del rat\u00f3n DCI Doble clic izquierdo del rat\u00f3n TC3 TwinCAT3 CV Campus Virtual FB Bloque funcional (Functional Block)"},{"location":"contenidos/01_conceptos/#crear-soluciones-en-tc3","title":"\ud83c\udfd7\ufe0f Crear soluciones en TC3","text":""},{"location":"contenidos/01_conceptos/#crear-proyecto-tc3","title":"Crear proyecto TC3","text":"<ol> <li>Abrir el software <code>Twincat XAE Shell</code>, desde el men\u00fa Inicio de Windows o desde el icono de la barra de programas en segundo plano que hay abajo a la derecha en la barra de tareas.</li> <li> <p>Seleccionar New TwinCAT Project.</p> <p></p> </li> <li> <p>Seleccionar el tipo TwinCAT XAE Project (XML format).</p> <p></p> </li> <li> <p>Darle un nombre a la Soluci\u00f3n, y seleccionar su ubicaci\u00f3n (la que viene por defecto est\u00e1 bien). Dejar marcada la opci\u00f3n Create directory for solution.</p> <p></p> <p>Ejemplo</p> <p><code>TC3_Lampara</code> </p> </li> <li> <p>Por defecto, tanto la Soluci\u00f3n de Visual Studio como el proyecto de TC3 tendr\u00e1n el mismo nombre.</p> </li> </ol> <p>Recomendaci\u00f3n</p> <p>Ocultar las secciones del proyecto que no se van a utilizar: <code>MOTION</code>, <code>SAFETY</code>, <code>C++</code>, <code>VISION</code>, <code>ANALYTICS</code>. Nos quedaremos solo con <code>SYSTEM</code>, <code>PLC</code> e <code>I/O</code>.</p>"},{"location":"contenidos/01_conceptos/#crear-proyecto-plc","title":"Crear proyecto PLC","text":"<ol> <li>Una vez creado un proyecto de TC3, procedemos a crear un proyecto PLC.</li> <li>Hacer CD sobre la secci\u00f3n <code>PLC</code> y seleccionar Add New Item.</li> <li> <p>Seleccionar Standard PLC Project, darle un nombre y pulsar Add. </p> <p>Ejemplo</p> <p><code>Lampara_PLC</code></p> </li> <li> <p>En la secci\u00f3n de <code>SYSTEM &gt; Tasks</code> aparecer\u00e1 por defecto una nueva tarea <code>PLC Task</code> con sus par\u00e1metros por defecto (ej. 10 ms de ciclo).</p> </li> <li> <p>En la secci\u00f3n <code>PLC</code> aparece el proyecto con dos secciones nuevas:</p> <ol> <li> <p><code>Project</code></p> <ol> <li><code>External Types</code>. Almacena definiciones de tipos de datos externos que provienen de fuentes externas al PLC.</li> <li><code>References</code>. Listado de referencias a las librer\u00edas utilizadas en el proyecto.</li> <li><code>DUTs</code>. Tipos de Dato de Usuario (Data User Types) (<code>ENUM</code>, <code>STRUCT</code>).</li> <li><code>GVLs</code>. Listas de Variables Globales (Global Variables Lists).</li> <li><code>POUs</code>. Unidades de Organizaci\u00f3n del Programa (Program Organization Units). Programas, bloques funcionales y funciones que implementaremos.</li> <li><code>VISUs</code>. Visualizaciones creadas.</li> <li> <p>Tarea creada (<code>PLCTask</code>) y programa <code>MAIN</code></p> <p></p> </li> </ol> </li> <li> <p><code>Instance</code>. Aqu\u00ed aparecer\u00e1n las variables en las im\u00e1genes de Entrada y Salida.</p> </li> </ol> </li> <li> <p>A partir de aqu\u00ed se puede empezar a implementar el proyecto.</p> </li> </ol>"},{"location":"contenidos/01_conceptos/#crear-bloque-funcional","title":"Crear bloque funcional","text":"<ol> <li>Hacer CD sobre la secci\u00f3n <code>POUs</code>.</li> <li>Seleccionar <code>Add \u2192 POU \u2192 Functional Block</code>.</li> <li>Darle un nombre significativo.</li> <li>Seleccionar el lenguaje a utilizar. Normalmente utilizaremos <code>ST</code> o <code>SFC</code>.</li> </ol>"},{"location":"contenidos/01_conceptos/#declaracion-de-variables","title":"\ud83c\udff7\ufe0f Declaraci\u00f3n de variables","text":"<p>Recomendaci\u00f3n</p> <p>Se recomienda utilizar la convenci\u00f3n CamelCase para declarar las variables.</p> <p>Como convenci\u00f3n adicional, a\u00f1adiremos un prefijo <code>i_</code> para aquellas variables que se declaren en la zona de entrada y <code>o_</code> para las de la zona de salida.</p> <ul> <li>Independientemente del lenguaje utilizado para implementar el c\u00f3digo, las variables se declaran de la misma manera.</li> <li>Las variables se declaran en la caja superior de la ventana del bloque funcional creado.</li> <li>La sintaxis para la declaraci\u00f3n de variables es la siguiente:</li> </ul> <pre><code>&lt;NombreVariable&gt; : &lt;tipo&gt; [:=&lt;ValorInicial&gt;]\n</code></pre> <p>Ejemplo</p> <pre><code>// bool\nPulsador: BOOL;\nLuzAmarilla: BOOL := TRUE;\n\n// enteros con y sin signo\nAltura: INT;\nContador: UINT;\nUnidadesSolicitadas: UINT := 10;\n\n// n\u00fameros reales\nTpoSegundos: FLOAT := 1.2;\n\n// tiempo\nTiempoEspera: TIME := T#2s;\nTiempoRestante: TIME;\n\n// bloques funcionales\nFlanco_Pulsador: R_TRIG; // detector de flanco (est\u00e1ndar)\nCoordinador: FB_Coordinador; // bloque funcional definido por el usuario\n\n// arrays\nOcupado: ARRAY[0..3] OF BOOL; // array de cuatro elementos de tipo BOOL; acceso con []\n</code></pre> <ul> <li> <p>La sintaxis de los valores posibles es la siguiente:</p> <ul> <li>Variables booleanas: <code>TRUE</code>, <code>FALSE</code>.</li> <li>Variables enteras: <code>0</code>, <code>1</code>, etc.</li> <li>Variables reales: <code>0.1</code>, <code>2.3</code>, etc.</li> <li> <p>Variables de tiempo: <code>T#&lt;tiempo&gt;</code> donde <code>&lt;tiempo&gt;</code> debe ser del estilo <code>&lt;numero&gt;&lt;unidad&gt;</code>, siendo <code>&lt;unidad&gt;</code> escogido de <code>{s, ms}</code>.</p> <p>Ejemplo</p> <p><code>T#2s</code> (dos segundos)</p> <p><code>T#500ms</code> (quinientos milisegundos).</p> </li> <li> <p>El acceso a los arrays se hace con el \u00edndice entre corchetes. </p> <p>Ejemplo</p> <p><code>Ocupado[1] := TRUE;</code></p> </li> </ul> </li> <li> <p>Las variables en TC3 se declaran dentro de los \u00e1mbitos existentes en el POU correspondiente: marcas (locales), entrada y salida.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/#variables-locales","title":"Variables locales","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR\n    Contador: UINT;\nEND_VAR\n</code></pre> <p>Las variables declaradas aqu\u00ed se pueden utilizar dentro del POU pero no pueden tomar valores de fuera del POU ni se pueden acceder desde fuera del POU.</p>"},{"location":"contenidos/01_conceptos/#variables-de-entrada","title":"Variables de entrada","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR_INPUT\n    TiempoEntrada: TIME;\n    TiempoSalida: TIME := T#2s;\nEND_VAR\n</code></pre> <p>Las variables declaradas aqu\u00ed deben ser especificadas al llamar al FB (a no ser que se les de un valor por defecto).</p> <p>Importante</p> <p>No especificarlas en la llamada produce un error de compilaci\u00f3n.</p>"},{"location":"contenidos/01_conceptos/#variables-de-salida","title":"Variables de salida","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR_OUTPUT\n    LuzAmarilla: BOOL;\n    LuzVerde: BOOL;\nEND_VAR\n</code></pre> <p>Las variables declaradas aqu\u00ed pueden ser accedidas desde fuera del FB (por ejemplo, desde otro FB que llama a este, o desde el programa <code>MAIN</code>).</p> <pre><code>PROGRAM MAIN\nVAR\n    Estacion: FB_Estacion\n    LuzAmarillaEstacion: BOOL;\nEND_VAR\n------------------\nLuzAmarillaEstacion := Estacion.LuzAmarilla; // esto es v\u00e1lido\n</code></pre> <p>Importante</p> <p>Querer acceder a una variable de un FB que no ha sido declarada como salida produce un error de compilaci\u00f3n.</p>"},{"location":"contenidos/01_conceptos/#variables-de-entrada-y-salida","title":"Variables de entrada y salida","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR_IN_OUT\n    Contador: UINT;\nEND_VAR\n</code></pre> <p>Este \u00e1mbito no aparece por defecto al crear un FB pero puede ser a\u00f1adido simplemente escribiendo la secci\u00f3n <code>VAR_IN_OUT ... END_VAR</code>.</p> <p>Las variables declaradas aqu\u00ed deben tomar un valor como entrada al FB y su valor final tras cada ciclo puede ser accedido desde fuera del FB.</p> <p>Combina las condiciones de los \u00e1mbitos de entrada y salida.</p> <ul> <li>En un programa (ej. <code>MAIN</code>) s\u00f3lo disponemos del \u00e1mbito <code>VAR</code>.</li> <li>En un FB, adem\u00e1s del \u00e1mbito <code>VAR</code>, disponemos de los \u00e1mbitos <code>VAR_INPUT</code> y <code>VAR_OUTPUT</code>.</li> </ul>"},{"location":"contenidos/01_conceptos/#variables-vinculadas-a-la-es","title":"Variables vinculadas a la E/S","text":"<p>Recuerda que la memoria del PLC est\u00e1 estructurada en tres secciones: la imagen de entrada, la imagen de salida y la zona de marcas.</p>"},{"location":"contenidos/01_conceptos/#zona-de-marcas","title":"Zona de marcas","text":"<p>Aqu\u00ed se guardar\u00e1n aquellas variables que son internas al programa y no van a ser vinculadas con terminales de entrada y salida.</p> <p>Las variables declaradas con la siguiente sintaxis se guardan en la zona de marcas:</p> <pre><code>VAR\n    Pulsador: BOOL;\n    Contador: UINT;\n    Lampara: BOOL;\nEND_VAR\n</code></pre>"},{"location":"contenidos/01_conceptos/#imagen-de-entrada","title":"Imagen de entrada","text":"<p>Aqu\u00ed se guardar\u00e1n las variables que queremos vincular a las entradas f\u00edsicas del sistema.</p> <p>Su sintaxis a\u00f1ade <code>AT %I*</code> antes de la definici\u00f3n del tipo:</p> <pre><code>VAR\n    i_Pulsador AT %I*: BOOL;\nEND_VAR\n</code></pre> <p>Importante</p> <p>Recuerda que en nuestro trabajo usaremos la convenci\u00f3n de a\u00f1adir un prefijo <code>i_</code> delante de estas variables.</p>"},{"location":"contenidos/01_conceptos/#imagen-de-salida","title":"Imagen de salida","text":"<p>Aqu\u00ed se guardar\u00e1n las variables que queremos vincular a las salidas f\u00edsicas del sistema.</p> <p>Su sintaxis a\u00f1ade <code>AT %Q*</code> antes de la definici\u00f3n del tipo:</p> <pre><code>VAR\n    o_Lampara AT %Q*: BOOL;\nEND_VAR\n</code></pre> <p>Importante</p> <p>Recuerda que en nuestro trabajo usaremos la convenci\u00f3n de a\u00f1adir un prefijo <code>o_</code> delante de estas variables.</p> <p>Importante</p> <p>Declarar una variable en la imagen de entrada o salida es independiente de que sean entradas o salidas del bloque funcional.</p> <p>Estas declaraciones son completamente correctas.</p> <pre><code>VAR_INPUT\n    Pulsador AT %I*: BOOL;\n    LamparaAmarilla AT %Q*: BOOL;\n    TiempoEspera: TIME;\nEND_VAR\n\nVAR\n    LamparaMarcha AT %Q*: BOOL;\nEND_VAR\n\nVAR_OUTPUT\n    PresenciaPale AT %I*: BOOL;\nEND_VAR\n</code></pre>"},{"location":"contenidos/01_conceptos/#creacion-de-duts","title":"\ud83d\udc6b Creaci\u00f3n de DUTs","text":"<p>Adem\u00e1s de los tipos de datos simples (<code>BOOL</code>, <code>INT</code>, etc.) y los bloques funcionales ya existentes (<code>R_TRIG</code>) o creados por nosotros (<code>FB_Coordinador_ST</code>), en ocasiones podemos necesitar crear tipos de dato que est\u00e1n compuestos por otros tipos de dato. A estos tipos de datos se les denomina tipos de unidad de datos (Data Unit Type, DUT).</p> <p>En nuestros proyectos vamos a poder hacer uso de dos de ellos: </p> <ul> <li>Estructuras (<code>STRUCT</code>)</li> <li>Enumeraciones (<code>ENUM</code>).</li> </ul>"},{"location":"contenidos/01_conceptos/#estructuras","title":"Estructuras","text":"<p>Aglutinan en su interior otros tipos de dato y se definen haciendo CD sobre la carpeta DUTs y escogiendo <code>Add \u2192 DUT</code>:</p> <p></p> <p>Se le da un nombre significativo (se recomienda comenzar con <code>ST</code> como, por ejemplo, <code>ST_PIEZA</code>), se deja marcado Structure y se pulsa en Open.</p> <p>Se abrir\u00e1 una ventana de texto para definir los componentes del tipo de dato:</p> <pre><code>TYPE ST_PIEZA :\nSTRUCT\n    Blanca: BOOL;\n    Baja: BOOL;\n    Tamano: INT;\n    Tiempo: TIME;\nEND_STRUCT\nEND_TYPE\n</code></pre> <p>Para usarlo, se define una variable de ese tipo y se accede a sus componentes mediante el operador <code>.</code> (punto):</p> <pre><code>// Definicion de variables\nVAR\n    Pieza: ST_PIEZA;\n    Baja: BOOL;\nEND_VAR\n--------------------------------\n// Implementacion\nPieza.Blanca := TRUE;\nBaja := (Pieza.Tamano &lt; 12);\nPieza.Tiempo := T#1s;\n</code></pre>"},{"location":"contenidos/01_conceptos/#enumeraciones","title":"Enumeraciones","text":"<p>Una enumeraci\u00f3n (<code>ENUM</code>) es un tipo de datos definido por el usuario compuesto por una serie de componentes separados por comas, tambi\u00e9n llamados valores de enumeraci\u00f3n, que se utiliza para declarar variables definidas por el usuario.</p> <p>Se definen haciendo CD sobre la carpeta DUTs y escogiendo <code>Add \u2192 DUT</code>:</p> <p></p> <p>Se le da un nombre significativo (se recomienda comenzar con <code>E</code> como, por ejemplo,  <code>E_ColorBasic</code>), se deja marcado Enumeration y se pulsa en Open.</p> <p>Se abrir\u00e1 una ventana de texto para definir los componentes del tipo de dato:</p> <pre><code>{attribute 'qualified_only'}\n{attribute 'strict'}\nTYPE E_ColorBasic :\n(\n    eRed, \n    eYellow,\n    eGreen,\n    eBlue,\n    eBlack\n) // Basic data type is INT, default initialization is eRed\n;\nEND_TYPE\n</code></pre> <p>Una variable definida con el tipo <code>E_ColorBasic</code> es, en realidad, de tipo <code>INT</code> y solo puede tomar los valores definidos en <code>E_ColorBasic</code>: <code>eRed</code>, <code>eYellow</code>, etc.</p> <p>Cada uno de esos valores tiene un valor <code>INT</code> asociado, comenzando por el cero: <code>eRed = 0</code>, <code>eYellow = 1</code>, etc.</p> <p>Para usarlo, se define una variable de ese tipo y se le asigna el valor deseado usando el nombre del tipo de dato Enumeration:</p> <pre><code>// Definicion de variables\nVAR\n    Color: E_ColorBasic;\nEND_VAR\n--------------------------------\n// Implementacion\nColor := E_ColorBasic.eYellow; // asignacion de valor\nIF Color &lt;&gt; E_ColorBasic.eRed THEN // comprobacion de valor\n    [...]\nEND_IF\n</code></pre>"},{"location":"contenidos/01_conceptos/#lenguaje-st","title":"\ud83d\udcc4 Lenguaje ST","text":"<p>Recomendaci\u00f3n</p> <p>Es recomendable acceder a la ayuda y documentaci\u00f3n del lenguaje ST (Structured Text) que ofrece Beckhoff en su portal Infosys.</p>"},{"location":"contenidos/01_conceptos/#sintaxis-general","title":"Sintaxis general","text":"<ul> <li>Las instrucciones deben terminar con <code>;</code>.</li> <li>Los comentarios se pueden realizar con <code>//</code> hasta final de l\u00ednea o metiendo el texto entre <code>(*</code> y <code>*)</code>.</li> <li>La asignaci\u00f3n de valores entre variables se realiza con el operador <code>:=</code>.</li> <li>La comparaci\u00f3n de valores se realiza con los operadores <code>=</code>, <code>&lt;&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>.</li> <li>Las operaciones l\u00f3gicas se realizan con los operadores <code>AND</code>, <code>OR</code> y <code>NOT</code>.</li> <li>La llamada a los FBs se realiza escribiendo el nombre de la instancia del FB seguido de, entre par\u00e9ntesis, las asignaciones de los valores para las variables de entrada (si las hay), separadas por comas: <code>&lt;nombre_instancia&gt;(var1:=val1, var2:=val2, ...);</code></li> <li> <p>En caso de que no haya ninguna variable de entrada que especificar, simplemente se abre y se cierra par\u00e9ntesis.</p> <p>Ejemplo</p> <p><code>Estacion();</code></p> <p><code>Lampara(TiempoEncedido:=T#2s);</code></p> </li> </ul>"},{"location":"contenidos/01_conceptos/#estructuras-de-control","title":"Estructuras de control","text":"<ul> <li>Las estructuras de control b\u00e1sicas son:<ul> <li>Condicionales (<code>if</code>, <code>case</code>)     <pre><code>IF &lt;condition&gt; THEN\n    &lt;statements&gt;\nELSIF &lt;condition&gt; THEN\n    &lt;statements&gt;\nELSE\n    &lt;statements&gt;\nEND_IF;\n\nCASE &lt;expression&gt; OF\n    &lt;value&gt;, &lt;value&gt;, \u2026, &lt;value&gt;: &lt;statements&gt;\nELSE\n    &lt;statements&gt;\nEND_CASE;\n</code></pre></li> <li>Bucles (<code>for</code>, <code>while</code>, <code>repeat</code>)     <pre><code>FOR &lt;variable&gt; := &lt;expression&gt; TO &lt;expression&gt; BY &lt;expression&gt; DO\n    &lt;statements&gt;\nEND_FOR;\n\nWHILE &lt;condition&gt; DO\n    &lt;statements&gt;\nEND_WHILE;\n\nREPEAT\n    &lt;statement&gt;\nUNTIL &lt;condition&gt;\nEND_REPEAT;\n</code></pre></li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/#lenguaje-sfc","title":"\u2935\ufe0f Lenguaje SFC","text":""},{"location":"contenidos/01_conceptos/#reglas-sintacticas","title":"Reglas sint\u00e1cticas","text":"<ul> <li>Los nombres de las etapas en SFC (Sequential Function Chart) no pueden empezar por un n\u00famero. Tampoco pueden tener espacios, puntos u otros caracteres especiales como e\u00f1es, interrogaciones, etc. S\u00ed permite guiones bajos.</li> <li>No puede haber dos etapas consecutivas ni dos transiciones consecutivas. Hay que tener especial atenci\u00f3n a esto cuando se produzcan bifurcaciones o saltos.</li> </ul>"},{"location":"contenidos/01_conceptos/#anadir-etapa-transicion","title":"A\u00f1adir etapa / transici\u00f3n","text":"<ul> <li>Hacer CD sobre la etapa donde queramos introducir una nueva y seleccionar Add step-transition o Add step-transition after, dependiendo de si queremos a\u00f1adirla antes o despu\u00e9s, respectivamente, de la etapa seleccionada.</li> </ul> <p>Importante</p> <p>Comprobar que no quedan dos etapas o dos transiciones consecutivas. En caso contrario, borrar aquello que no sirva (CI sobre \u00e9l y pulsar Supr).</p>"},{"location":"contenidos/01_conceptos/#asociar-acciones-a-etapas","title":"Asociar acciones a etapas","text":""},{"location":"contenidos/01_conceptos/#accion-continua","title":"Acci\u00f3n continua","text":"<ul> <li>Hacer CD sobre la etapa a la que queramos asociar una acci\u00f3n no memoriza (o continua) y seleccionar Insert action association o Insert action association after, dependiendo de si queremos insertarla antes o despu\u00e9s de las ya existentes (si las hay).</li> <li> <p>En la caja de la acci\u00f3n aparece en primer lugar el modificador (por defecto <code>N</code>, que significa \"No memorizada\") y en segundo lugar el hueco donde debemos poner la acci\u00f3n a realizar (una variable booleana que queramos activar o una acci\u00f3n m\u00e1s compleja definida como acci\u00f3n asociada al bloque funcional).</p> <p></p> <ul> <li> <p>Tipos de modificadores de acciones</p> C\u00f3digo Tipo Descripci\u00f3n <code>N</code> No memorizada (continua) Se ejecuta/activa mientras la etapa est\u00e9 activa. <code>R0</code> Reinicio La acci\u00f3n se desactiva. <code>S0</code> Activaci\u00f3n Se ejecuta cuando se activa la etapa y contin\u00faa activa aunque la etapa se desactive. <code>L</code> Limitada Se ejecuta cuando se activa la etapa y se desactiva cuando la etapa se desactiva o se alcanza el tiempo especificado. <code>D</code> Retrasada Se ejecuta un tiempo despu\u00e9s de que se active la etapa y se desactiva cuando la etapa se desactiva. <code>P</code> Pulsada Se ejecuta dos veces: cuando se activa la etapa y una vez m\u00e1s en el ciclo siguiente. <code>SD</code> Activaci\u00f3n con retardo Se activa aunque la etapa ya no est\u00e9 activa. <code>DS</code> Retardo de activaci\u00f3n Se activa solo si la etapa permanece activa. <code>SL</code> Activaci\u00f3n limitada Activaci\u00f3n con duraci\u00f3n limitada. <p>Importante</p> <p>Usaremos, por defecto, las acciones no memorizadas, aunque se pueden usar las otras si tiene sentido para el proyecto.</p> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/#accion-de-entrada-o-salida","title":"Acci\u00f3n de entrada o salida","text":"<ul> <li>Podemos crear acciones con activaci\u00f3n a la entrada o a la salida de una etapa.</li> <li> <p>Estas acciones se implementan en alguno de los lenguajes de la norma y permiten realizar acciones que se ejecutan solo una vez durante la etapa, en lugar de hacerse de manera continua.</p> <ul> <li> <p>A la entrada</p> <ul> <li>Las acciones con activaci\u00f3n a la entrada se ejecutan solo una vez inmediatamente despu\u00e9s de entrar en la etapa donde se asocian. Posteriormente se comprueba si la condici\u00f3n de transici\u00f3n para pasar a la siguiente etapa es cierta o no.</li> <li>Normalmente usaremos estas acciones para inicializar variables memorizadas, actualizar contadores, etc.</li> <li>Para crear una de este tipo, hacer CD sobre la etapa donde la queremos asociar y seleccionar Add entry action.</li> <li> <p>Aparece un popup donde se nos pregunta por el nombre que le queremos poner y el lenguaje a utilizar. Se recomienda dejar el nombre por defecto (<code>S0_entry</code> en la figura) ya que nos indica en qu\u00e9 etapa est\u00e1 y de qu\u00e9 tipo es.</p> <p></p> </li> <li> <p>En nuestros proyectos, estas acciones siempre ser\u00e1n en <code>ST</code>, pero podr\u00edan ser implementadas en cualquier otro lenguaje de la norma.</p> </li> <li> <p>Una vez creada, aparece en el programa <code>SFC</code> como un cuadrado con una E en la esquina inferior izquierda de la etapa.</p> <p></p> </li> </ul> </li> <li> <p>A la salida</p> <ul> <li>Las acciones con activaci\u00f3n a la salida se ejecutan solo una vez inmediatamente antes de pasar a la siguiente etapa. Esto implica que antes de que se ejecute esta acci\u00f3n, la condici\u00f3n de transici\u00f3n para pasar a la siguiente etapa debe ser cierta.</li> <li>Normalmente usaremos estas acciones para inicializar variables memorizadas, actualizar contadores, etc.</li> <li>Para crear una de este tipo, hacer CD sobre la etapa donde la queremos asociar y seleccionar Add exit action.</li> <li> <p>Aparece un popup donde se nos pregunta por el nombre que le queremos poner y el lenguaje a utilizar. Se recomienda dejar el nombre por defecto (<code>S0_exit</code> en la figura) ya que nos indica en qu\u00e9 etapa est\u00e1 y de qu\u00e9 tipo es.</p> <p></p> </li> <li> <p>En nuestros proyectos, estas acciones siempre ser\u00e1n en <code>ST</code>, pero podr\u00edan ser implementadas en cualquier otro lenguaje de la norma.</p> </li> <li> <p>Una vez creada, aparece en el programa <code>SFC</code> como un cuadrado con una X en la esquina inferior derecha de la etapa.        </p> <p>Importante</p> <p>Nada impide que una etapa tenga asociadas una o varias acciones no memorizadas, una con activaci\u00f3n a la entrada y otra con activaci\u00f3n a la salida.</p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/#accion-principal-todo","title":"Acci\u00f3n principal (TODO)","text":""},{"location":"contenidos/01_conceptos/#estructuras-de-evolucion","title":"\ud83d\udd00 Estructuras de evoluci\u00f3n","text":""},{"location":"contenidos/01_conceptos/#secuencia-basica","title":"Secuencia b\u00e1sica","text":"<ul> <li> <p>Una secuencia b\u00e1sica se compone de una sucesi\u00f3n lineal de etapas y transiciones, donde las primeras se van a ir ejecutando en secuencia conforme las condiciones asociadas a las segundas se vayan cumpliendo.</p> </li> <li> <p>Normalmente, al final de la secuencia se producir\u00e1 un salto hacia atr\u00e1s (o el inicio) en el programa.</p> <p></p> </li> <li> <p>Para insertar un salto detr\u00e1s de una transici\u00f3n, hay que hacer CD sobre la transici\u00f3n y seleccionar Insert jump after. Solo hay que indicar el nombre de la etapa a la que queremos saltar.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/#bifurcacion","title":"Bifurcaci\u00f3n","text":"<ul> <li> <p>Tras una etapa podemos realizar una bifurcaci\u00f3n en distintas ramas en funci\u00f3n de distintas condiciones. Esto nos permite dirigir la secuencia por cambio si ocurre un evento y por otros distintos si ocurren otros eventos.</p> </li> <li> <p>En el ejemplo de la figura, si la etapa <code>Init</code> est\u00e1 activa y se activa <code>Execute</code>, el programa evolucionar\u00e1 por la rama de la izquierda llegando a <code>S0</code>. Si lo que se activa es <code>Restore</code>, el programa evolucionar\u00e1 por la derecha pasando a <code>Sr</code> y, una vez se active <code>Restaurado</code>, la secuencia pasar\u00e1 a <code>S0</code>.</p> <p></p> </li> <li> <p>Para realizar una bifurcaci\u00f3n, hacer CD sobre la transici\u00f3n donde se quiera hacer la bifurcaci\u00f3n (<code>Execute</code> en el ejemplo) y seleccionar Insert branch right.</p> </li> <li> <p>Nada impide que se pueda hacer una bifurcaci\u00f3n con m\u00e1s de dos ramas.</p> </li> <li> <p>Es recomendable que las condiciones de la bifurcaci\u00f3n sean excluyentes pero nada impide que no lo sean. El programa tomar\u00e1 el camino de la primera transici\u00f3n cuya condici\u00f3n sea verdadera.</p> </li> <li> <p>Si ocurriera que varias o todas las condiciones son verdaderas a la vez, el programa evolucionar\u00e1 por la rama de la izquierda. Aunque esto puede ser \u00fatil en algunos casos, esto suele indicar que hay un mal dise\u00f1o en el programa.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/#paralelismo","title":"Paralelismo","text":"<ul> <li> <p>Si queremos que el programa evolucione por dos secuencias en paralelo (se ejecutan simult\u00e1neamente) podemos incluir un paralelismo en el c\u00f3digo.</p> </li> <li> <p>En el ejemplo de la figura, si la etapa <code>Init</code> est\u00e1 activa y se activa <code>Execute</code>, el programa evolucionar\u00e1 por ambas ramas a la vez, activando los estados <code>S0</code> y <code>Sr</code> de manera simult\u00e1nea (y por tanto, <code>LuzRoja</code> y <code>Restaura</code>).</p> <p></p> </li> <li> <p>En la transici\u00f3n con condici\u00f3n <code>NOT Pulsador OR S0.t&gt;T#5s</code> se produce un punto de sincronizaci\u00f3n ya que, para que el programa evolucione a <code>S1</code> debe ocurrir que <code>S0</code> y <code>Sr2</code> est\u00e9n activas y, adem\u00e1s, que la condici\u00f3n <code>NOT Pulsador OR S0.t&gt;T#5s</code> sea cierta. Por tanto, podemos decir que el programa esperar\u00e1 hasta que termine la rama de la derecha antes de evolucionar.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/#crear-visualizacion","title":"\ud83d\udda5\ufe0f Crear visualizaci\u00f3n","text":"<ul> <li> <p>Hacer CD sobre la secci\u00f3n <code>VISUs</code>.</p> </li> <li> <p>Seleccionar <code>Add \u2192 Visualization</code> y pulsar en Open en la ventana popup.</p> <p></p> </li> <li> <p>En la parte derecha de la pantalla aparecer\u00e1 la secci\u00f3n <code>Toolbox</code> donde, en la secci\u00f3n <code>Basic</code> aparecen las formas b\u00e1sicas. Arrastrar a la visualizaci\u00f3n los elementos que se quieran.</p> </li> </ul> <p>Importante</p> <p>Si no aparece la secci\u00f3n, mostrarlo entrando en el Men\u00fa <code>View \u2192 Toolbox</code></p> <p>Recomendaci\u00f3n</p> <p>Se recomienda utilizar rect\u00e1ngulos para crear botones tanto para las entradas como para las salidas.</p>"},{"location":"contenidos/01_conceptos/#botones-para-cambiar-valores-de-variables","title":"Botones para cambiar valores de variables","text":"<ul> <li> <p>Dibujar un rect\u00e1ngulo con el tama\u00f1o deseado.</p> </li> <li> <p>Escribir dentro la etiqueta que queramos que aparezca en el bot\u00f3n.</p> </li> <li> <p>Introducir la variable de tipo <code>BOOL</code> que queremos asociar a dicho bot\u00f3n. Dependiendo del comportamiento que queramos que tenga el bot\u00f3n, esta variable se introduce en una secci\u00f3n distinta dentro de <code>Properties \u2192 Input Configuration</code> (la pesta\u00f1a <code>Properties</code> aparece a la derecha, normalmente combinada con <code>Toolbox</code>).</p> <ul> <li> <p>Si queremos que la variable cambie de valor mientras se pulsa el bot\u00f3n con el rat\u00f3n pero vuelva a su valor anterior una vez soltado el rat\u00f3n, introduciremos la variable en la secci\u00f3n <code>Tap</code>:</p> <p></p> </li> <li> <p>Si queremos que la variable cambie de valor cada vez que pulsemos el bot\u00f3n (el valor conmutar\u00e1 entre <code>TRUE</code> y <code>FALSE</code>) lo introduciremos en la secci\u00f3n <code>Toggle</code>:</p> <p></p> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/#exportar-e-importar","title":"\ud83d\udd04 Exportar e importar","text":"<ol> <li>Podemos exportar <code>POUs</code> y <code>VISUs</code> desde una soluci\u00f3n de TC3 e importarla de nuevo en otra distinta. De esta manera podemos reutilizar c\u00f3digo de distintas proyectos.</li> <li>Para realizar esto, en la soluci\u00f3n origen, simplemente hay que hacer CD sobre el <code>POU</code> o <code>VISU</code> a exportar y seleccionar Export to ZIP. Se selecciona donde guardar el archivo exportado y se pulsa Save.</li> <li>Posteriormente, en la soluci\u00f3n destino, hacer CD sobre la carpeta <code>POU</code> o <code>VISU</code> y seleccionar Import from ZIP. Se busca el archivo correspondiente y se pulsa OK.</li> </ol>"},{"location":"contenidos/01_conceptos/#guardar-y-mover-proyectos","title":"\ud83d\udcbe Guardar y mover proyectos","text":"<p>Importante</p> <p>Se ha detectado que el sincronizar la carpeta del proyecto usando servicios como Google Drive est\u00e1 produciendo problemas a la hora de poder abrir los proyectos. Posiblemente esto se deba a que algunos ficheros no son sincronizados correctamente por Drive (por motivos desconocidos), lo que lleva a que, a la hora de abrir el proyecto, no se carguen los ficheros necesarios. </p> <p>Se recomienda, por tanto, no usar este m\u00e9todo sino alguno de los otros.</p>"},{"location":"contenidos/01_conceptos/#usando-la-carpeta-completa","title":"Usando la carpeta completa","text":"<ol> <li>Es la manera m\u00e1s sencilla de llevarse un proyecto desde un equipo a otro.</li> <li> <p>Solo hay que copiar la carpeta ra\u00edz en un pendrive y pegar la carpeta en el equipo destino.</p> <p></p> </li> <li> <p>Posteriormente, hacer DCI sobre el fichero de Solution (<code>.sln</code>) para que se abra de nuevo en TC3.</p> </li> </ol> <p>Importante</p> <p>Si la carpeta ha sido comprimida para ser trasladada, hay que asegurarse de haber descomprimido la carpeta completa en el destino antes de abrir el proyecto.</p>"},{"location":"contenidos/01_conceptos/#exportando-como-tnzip","title":"Exportando como <code>.tnzip</code>","text":"<p>Importante</p> <p>La entrega final del proyecto deber\u00e1 seguir este procedimiento.</p> <ol> <li>Este proceso genera el m\u00ednimo tama\u00f1o posible para trasladar un proyecto.</li> <li>Seleccionar <code>File \u2192 Save [nombre_del_proyecto] as Archive...</code>.</li> <li>Seleccionar d\u00f3nde guardar el proyecto, darle un nombre y asegurarse de que el formato es de tipo <code>.tnzip</code>.</li> <li>Para volver a abrir el proyecto:</li> <li>Abrir TC3.</li> <li>Seleccionar <code>File \u2192 Open \u2192 Solution from Archive...</code>.</li> <li>Buscar el archivo <code>.tnzip</code>.</li> <li>Seleccionar (o crear si no existe) una carpeta donde se va a generar la Solution.</li> <li>En principio, se puede seleccionar siempre la misma carpeta cada vez que se repita este procedimiento.</li> </ol> <p>Importante</p> <p>Si al abrir el proyecto de nuevo y compilar obtienes errores no relacionados con el c\u00f3digo que antes no ten\u00edas:</p> <ul> <li>Cambiar el tipo de proyecto a TwinCAT RT (x86)</li> <li>Recompilar</li> <li>Volver a cambiar a TwinCAT RT (x64)</li> <li>Volver a recompilar</li> </ul>"},{"location":"contenidos/01_conceptos/#usando-git","title":"Usando GIT","text":"<p>TwinCAT3, al estar basado en Visual Studio, tiene compatibilidad directa con GitHub.  Se recomienda seguir el tutorial en este video:</p> <p>PLC Programming using TwinCAT 3 - Version control</p>"},{"location":"contenidos/01_conceptos/#convenciones-de-nombres","title":"\ud83d\udcdd Convenciones de nombres","text":"<p>Se recomienda llamar a todos los elementos del proyecto con el nombre adecuado desde el principio, ya que renombrar a posteriori puede acarrear problemas derivados del acceso a elementos cuya ruta ha cambiado. No obstante, si es necesario renombrar los elementos, el procedimiento es como sigue.</p>"},{"location":"contenidos/01_conceptos/#soluciones","title":"Soluciones","text":"<p>Se recomienda llamar a las soluciones de TC3 de la misma forma que los Proyectos de TC3.</p> <p>Para renombrarlo una vez creado:</p> <ol> <li> <p>CD sobre el nombre de la soluci\u00f3n y seleccionar Rename.</p> <p></p> </li> <li> <p>Escribir el nuevo nombre.</p> </li> </ol>"},{"location":"contenidos/01_conceptos/#proyectos-twincat3","title":"Proyectos TwinCAT3","text":"<ul> <li> <p>Se recomienda llamar a los proyectos TC3 de la siguiente forma:</p> <ul> <li> <p>Para los ejemplos: <code>TC3_[nombre]</code>   donde el nombre debe ser algo significativo.</p> <p>Ejemplo</p> <p><code>TC3_Lampara</code></p> <p><code>TC3_Carro</code></p> </li> <li> <p>Para los trabajos finales: <code>[codigo]_TC3_G[grupo]</code>   donde <code>codigo</code> debe escogerse seg\u00fan la asignatura (<code>AIM</code>, <code>AIE</code>, <code>SR</code>, etc.) y <code>grupo</code> debe ser el n\u00famero del grupo con dos d\u00edgitos (<code>01</code>, <code>02</code>, ...).</p> <p>Ejemplo</p> <p><code>AIM_TC3_G01</code></p> <p><code>SR_TC3_G12</code></p> </li> <li> <p>C\u00f3digos de las asignaturas:</p> C\u00f3digo Asignatura AIM Automatizaci\u00f3n Industrial de GIERM AIE Automatizaci\u00f3n Industrial de GIEI o GIEI+IEL SR Sistemas Robotizados de GITI </li> <li> <p>Para renombrarlo una vez creado:</p> <ul> <li> <p>CD sobre el nombre del proyecto TC3 y seleccionar Rename.</p> <p></p> </li> <li> <p>Escribir el nuevo nombre.</p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/#proyectos-plc","title":"Proyectos PLC","text":"<ul> <li> <p>Se recomienda llamar a los proyectos PLC de la forma <code>[nombre]_PLC</code> para los ejemplos o <code>[estacion]_[nivel]_PLC</code> para los trabajos, donde el nombre debe ser algo significativo.</p> <p>Ejemplo</p> <p><code>Lampara_PLC</code></p> <p><code>FMS201_Monolitico_PLC</code></p> </li> <li> <p>Para renombrarlo una vez creado:</p> <ol> <li> <p>CD sobre el nombre del proyecto PLC y seleccionar Rename.</p> <p></p> </li> <li> <p>Escribir el nuevo nombre.</p> </li> <li> <p>Aparecer\u00e1 un aviso indicando que si se cambia el nombre del proyecto no se van a poder hacer cambios online (en caso de que se est\u00e9 ejecutando). CI en S\u00ed.</p> <p></p> </li> <li> <p>Tras unos segundos, el proyecto PLC habr\u00e1 cambiado de nombre.</p> </li> <li>Importante: Puede ocurrir que, tras el cambio de nombre, al hacer CI sobre el proyecto, salga un aviso de error por no encontrar el nombre anterior. Esto se debe solucionar haciendo CI sobre <code>Build \u2192 Rebuild Solution</code>.</li> </ol> </li> </ul>"},{"location":"contenidos/01_conceptos/#bloques-funcionales","title":"Bloques Funcionales","text":"<ul> <li>Se recomienda llamar a los bloques funcionales de la forma <code>FB_[nombre]_[lenguaje]</code>, donde el nombre debe ser algo significativo.</li> <li> <p>Los lenguajes suelen ser:</p> <ul> <li><code>ST</code> (Structured Text)</li> <li><code>SFC</code> (Sequential Function Chart)</li> </ul> <p>Ejemplo</p> <p><code>FB_Estacion_ST</code></p> <p><code>FB_Coordinador_ST</code></p> <p><code>FB_Alimentador_SFC</code></p> </li> <li> <p>Para renombrarlo una vez creado:</p> <ol> <li>CD sobre el nombre del FB y seleccionar Rename.</li> <li>Escribir el nuevo nombre.</li> <li> <p>Aparecer\u00e1 un aviso indicando que se van a adaptar todas las referencias en el proyecto. Pulsar en Yes.</p> <p></p> </li> <li> <p>Aparecer\u00e1 una ventana mostrando todos los cambios que se van a realizar. Pulsar en OK.</p> <p></p> </li> </ol> </li> </ul>"},{"location":"contenidos/01_conceptos/#variables","title":"Variables","text":"<ul> <li>Se recomienda llamar a las variables con nombres significativos.</li> <li>Si las variables se van a asociar con los terminales de entrada y salida, es obligatorio llamarlas con el nombre indicado en la columna Variable de la tabla de E/S.</li> <li>Para renombrar una variable y que ese cambio se corrija en todas las referencias que se hagan a la misma en el proyecto, hay que hacer CD sobre el nombre de la variable y seleccionar <code>Refactoring \u2192 Rename</code>.</li> <li> <p>Aparecer\u00e1 un popup donde se debe indicar el nuevo nombre.</p> <p></p> </li> <li> <p>Aparecer\u00e1 una ventana mostrando todos los cambios que se van a realizar. Pulsar en OK.</p> <p></p> </li> </ul>"},{"location":"contenidos/01_conceptos/#ejecutar-programa","title":"\u25b6\ufe0f Ejecutar programa","text":"<p>Una vez el programa est\u00e1 implementado (independientemente del lenguaje utilizado):</p> <ul> <li>Compilar el proyecto: Men\u00fa <code>Build \u2192 Build [nombre del proyecto]</code>.</li> <li>Asegurarse de que no hay errores.</li> <li> <p>Si has declarado variables en las im\u00e1genes de entrada y/o salida:     </p> <ul> <li> <p>Comprobar que las variables aparecen en la zona de la instancia.</p> <p></p> </li> </ul> </li> <li> <p>Si quieres utilizar el Equipo Remoto:</p> <ul> <li>Vincular las variables con los terminales correspondientes seg\u00fan la tabla de E/S:<ul> <li>DCI sobre la variable a vincular.</li> <li>Seleccionar el terminal/canal deseado del listado que aparece.</li> </ul> </li> <li>Buscar el equipo remoto.</li> </ul> </li> <li> <p>Si quieres usar el Runtime local</p> <ul> <li> <p>Asegurarte de que seleccionar <code>`Local</code> en el desplegable del <code>Target</code>. </p> <p></p> </li> </ul> </li> <li> <p>Activar la configuraci\u00f3n en el <code>Target</code> (Activate Configuration) y activar el modo de ejecuci\u00f3n (Run Mode). Esto \u00faltimo te lo pregunta TwinCAT3 en una ventana popup.</p> <p></p> </li> <li> <p>Descargar el programa en el <code>Target</code> (Login), donde se preguntar\u00e1, en un popup, si quieres crear un puerto de comunicaci\u00f3n con el <code>Target</code> y descargar el programa. Pulsar en Yes.</p> <p></p> </li> <li> <p>Ejecutar el programa (Start).</p> <p></p> </li> </ul> <p>Importante</p> <p>Para poder modificar de nuevo el programa, primero hay que parar el programa (Stop) [recomendado] y posteriormente hacer Logout.</p> <p></p>"},{"location":"contenidos/01_conceptos/#activardesactivar-hardware","title":"\ud83d\udd0c Activar/desactivar hardware","text":"<ol> <li>Si has vinculado las variables de tu programa con el equipo remoto (hiciste la b\u00fasqueda del equipo remoto y la exploraci\u00f3n de los m\u00f3dulos de E/S), cuando quieras probar tu programa en el Runtime Local, aparecer\u00e1 una ventana popup indicando un error.</li> <li>Esto se debe a que TC3 quiere establecer conexi\u00f3n con el hardware al que estuviste conectado pero no puede, ya que el <code>Target</code> es el local.</li> <li>Para evitar esto, solo tienes que deshabilitar el hardware haciendo CD sobre el dispositivo buscado y seleccionar Disable.</li> </ol> <p>Importante</p> <p>Recuerda volver a habilitarlo cuando quieras volver a usar el equipo remoto.</p>"},{"location":"contenidos/01_conceptos/#busqueda-de-equipos","title":"\ud83c\udf10 B\u00fasqueda de equipos","text":"<p>Recomendaci\u00f3n</p> <p>Hay un video de ejemplo en el Campus Virtual en <code>Automatizaci\u00f3n &gt; Videos &gt; TC3</code> con nombre <code>9_Runtime_Target_*.mkv</code>.</p>"},{"location":"contenidos/01_conceptos/#enlace-de-variables-y-es","title":"\ud83d\udd17 Enlace de variables y E/S","text":"<p>Recomendaci\u00f3n</p> <p>Hay un video de ejemplo en el Campus Virtual en <code>Automatizaci\u00f3n &gt; Videos &gt; TC3</code> con nombre <code>9_Runtime_Target_*.mkv</code>.</p>"},{"location":"contenidos/02_tc3_demo/","title":"\ud83d\udc4b Demo (TwinCAT 3)","text":"<p>Enlace al repositorio en Github: TC3_Demo</p>"},{"location":"contenidos/02_tc3_demo/#descripcion-del-proyecto","title":"\ud83d\udcdd Descripci\u00f3n del Proyecto","text":"<p>El proyecto Demo pretende ser un Hola Mundo para automatas programables (PLC). </p> <p>Es un proyecto m\u00ednimo y funcional, que muestra la declaraci\u00f3n y el uso b\u00e1sico de variables booleanas y enteras, ubicadas en los espacios de memoria de marcas, imagen de entrada e imagen de salida. Cubriendo los elementos esenciales de programaci\u00f3n de los lenguajes de la norma IEC 61131-3 para la programaci\u00f3n de PLC.</p> <p></p> <p>Este proyecto incluye adem\u00e1s, una visualizaci\u00f3n elemental que permite interactuar con las variables del proyecto, con objetos gr\u00e1ficos. Formas rectangulares para mostrar el valor de variables booleanas y num\u00e9ricas y botones para modificar el valor de variables booleanas y num\u00e9ricas.</p>"},{"location":"contenidos/02_tc3_demo/#codigo","title":"\ud83d\udcbb C\u00f3digo","text":"<pre><code>PROGRAM MAIN\nVAR\n    ContadorCiclos    : UINT; // Variable num\u00e9rica en el espacio de marcas\n    i_Pulsador AT %I* : BOOL; // Variable booleana en la imagen de entrada\n    o_Lampara  AT %Q* : BOOL; // Variable booleana en la imagen de salida\nEND_VAR\n\n// Uso de una variable num\u00e9rica (se incrementa con cada ciclo de ejecuci\u00f3n)\nContadorCiclos := ContadorCiclos + 1;\n\n// Uso de variables de entrada y salida booleanas (copia la entrada en la salida)\no_Lampara := i_Pulsador;\n</code></pre>"},{"location":"contenidos/02_tc3_demo/#comentarios","title":"\ud83d\udcac Comentarios","text":"<ul> <li>La variable <code>ContadorCiclos</code> se incrementa indefinidamente una vez por ciclo b\u00e1sico de ejecuci\u00f3n del PLC (10 ms).</li> <li>La variable de salida <code>o_Lampara</code> copia, continuamente, el valor de la variable de entrada <code>i_Pulsador</code></li> <li>El valor de la variable <code>ContadorCiclos</code> se muestra en la visualizaci\u00f3n.</li> <li>La variable <code>ContadorCiclos</code> puede reinicarse si se acciona el pulsador <code>Reinicia</code></li> <li>El valor de la variable <code>o_Lampara</code> se muestra con el cambio de color del rect\u00e1ngulo <code>Lampara</code> (verde claro = <code>false</code>, verde oscuro = <code>true</code>)</li> <li>El valor de la variabale <code>i_Pulsador</code> cambia cuando se acciona el bot\u00f3n <code>Pulsador</code></li> </ul>"},{"location":"contenidos/02_tc3_demo/#requisitos-del-sistema","title":"\ud83d\udcbb Requisitos del Sistema","text":""},{"location":"contenidos/02_tc3_demo/#software","title":"Software","text":"<ul> <li>IDE: Microsoft Visual Studio / TwinCAT 3 XAE (Versi\u00f3n m\u00ednima recomendada: 3.1.4024.x).</li> <li>Lenguajes: Texto Estructurado (ST) y Diagrama de Funciones Secuenciales (SFC).</li> </ul>"},{"location":"contenidos/02_tc3_demo/#puesta-en-marcha","title":"\ud83d\ude80 Puesta en Marcha","text":"<p>Para descargar, compilar y ejecutar este proyecto en el entorno de TwinCAT 3, sigua los siguientes pasos:</p> <ol> <li>Clonar Repositorio:</li> </ol> <pre><code>    git clone https://github.com/vetorres-uma/TC3_Demo.git\n</code></pre> <ol> <li>Abrir el Proyecto: abra el archivo <code>.sln</code> (Soluci\u00f3n) ubicado en la carpeta principal utilizando el entorno de ingenier\u00eda TwinCAT XAE (integrado en Visual Studio).</li> <li>Selecci\u00f3n del Controlador: seleccione el simulador (UmRT_Default) o controlador local o remoto (Choose Runtime System).</li> <li>Activaci\u00f3n de Configuraci\u00f3n: en el modo Configuraci\u00f3n, active la configuraci\u00f3n (Activate Configuration)) y reinicie TwinCAT en modo Ejecuci\u00f3n (Run Mode).</li> <li>Carga del C\u00f3digo: en el entorno PLC, inicie la sesi\u00f3n y descargue el programa al PLC (Login).</li> <li>Poner el c\u00f3digo en ejecuci\u00f3n: ejecute la l\u00f3gica de control en el controlador (Start). Puede utilizar la visualizaci\u00f3n integrada en el proyecto PLC para facilitar la prueba.</li> </ol>"},{"location":"contenidos/02_tc3_demo/#contribuciones","title":"\ud83e\udd1d Contribuciones","text":"<p>Este proyecto es utilizado con fines educativos y de prueba. Las contribuciones, sugerencias o correcciones de errores son bienvenidas. Por favor, abra un Issue o env\u00ede un Pull Request si deseas contribuir.</p>"},{"location":"contenidos/02_tc3_demo/#autor","title":"\ud83e\uddd1\u200d\ud83d\udcbb Autor","text":"<ul> <li>Autor Principal: Victor Torres ([@vetorres-uma] https://github.com/vetorres-uma)</li> <li>Revisor: Manuel Castellano ([mcastellanoquero] https://github.com/mcastellanoquero)</li> </ul>"},{"location":"contenidos/02_tc3_demo/#licencia","title":"\u2696\ufe0f Licencia","text":"<p>Este proyecto es de c\u00f3digo abierto y est\u00e1 disponible bajo la Licencia P\u00fablica General GNU (GPL).</p> <ul> <li>Consulte el archivo <code>LICENSE.md</code> para m\u00e1s detalles.</li> </ul>"},{"location":"contenidos/01_conceptos/00_leyenda/","title":"00 leyenda","text":"Leyenda Abrev. Significado CD Clic derecho del rat\u00f3n CI Clic izquierdo del rat\u00f3n DCI Doble clic izquierdo del rat\u00f3n TC3 TwinCAT3 CV Campus Virtual FB Bloque funcional (Functional Block)"},{"location":"contenidos/01_conceptos/01_tc3_crear_soluciones/","title":"01 tc3 crear soluciones","text":""},{"location":"contenidos/01_conceptos/01_tc3_crear_soluciones/#crear-soluciones-en-tc3","title":"\ud83c\udfd7\ufe0f Crear soluciones en TC3","text":""},{"location":"contenidos/01_conceptos/01_tc3_crear_soluciones/#crear-proyecto-tc3","title":"Crear proyecto TC3","text":"<ol> <li>Abrir el software <code>Twincat XAE Shell</code>, desde el men\u00fa Inicio de Windows o desde el icono de la barra de programas en segundo plano que hay abajo a la derecha en la barra de tareas.</li> <li> <p>Seleccionar New TwinCAT Project.</p> <p></p> </li> <li> <p>Seleccionar el tipo TwinCAT XAE Project (XML format).</p> <p></p> </li> <li> <p>Darle un nombre a la Soluci\u00f3n, y seleccionar su ubicaci\u00f3n (la que viene por defecto est\u00e1 bien). Dejar marcada la opci\u00f3n Create directory for solution.</p> <p></p> <p>Ejemplo</p> <p><code>TC3_Lampara</code> </p> </li> <li> <p>Por defecto, tanto la Soluci\u00f3n de Visual Studio como el proyecto de TC3 tendr\u00e1n el mismo nombre.</p> </li> </ol> <p>Recomendaci\u00f3n</p> <p>Ocultar las secciones del proyecto que no se van a utilizar: <code>MOTION</code>, <code>SAFETY</code>, <code>C++</code>, <code>VISION</code>, <code>ANALYTICS</code>. Nos quedaremos solo con <code>SYSTEM</code>, <code>PLC</code> e <code>I/O</code>.</p>"},{"location":"contenidos/01_conceptos/01_tc3_crear_soluciones/#crear-proyecto-plc","title":"Crear proyecto PLC","text":"<ol> <li>Una vez creado un proyecto de TC3, procedemos a crear un proyecto PLC.</li> <li>Hacer CD sobre la secci\u00f3n <code>PLC</code> y seleccionar Add New Item.</li> <li> <p>Seleccionar Standard PLC Project, darle un nombre y pulsar Add. </p> <p>Ejemplo</p> <p><code>Lampara_PLC</code></p> </li> <li> <p>En la secci\u00f3n de <code>SYSTEM &gt; Tasks</code> aparecer\u00e1 por defecto una nueva tarea <code>PLC Task</code> con sus par\u00e1metros por defecto (ej. 10 ms de ciclo).</p> </li> <li> <p>En la secci\u00f3n <code>PLC</code> aparece el proyecto con dos secciones nuevas:</p> <ol> <li> <p><code>Project</code></p> <ol> <li><code>External Types</code>. Almacena definiciones de tipos de datos externos que provienen de fuentes externas al PLC.</li> <li><code>References</code>. Listado de referencias a las librer\u00edas utilizadas en el proyecto.</li> <li><code>DUTs</code>. Tipos de Dato de Usuario (Data User Types) (<code>ENUM</code>, <code>STRUCT</code>).</li> <li><code>GVLs</code>. Listas de Variables Globales (Global Variables Lists).</li> <li><code>POUs</code>. Unidades de Organizaci\u00f3n del Programa (Program Organization Units). Programas, bloques funcionales y funciones que implementaremos.</li> <li><code>VISUs</code>. Visualizaciones creadas.</li> <li> <p>Tarea creada (<code>PLCTask</code>) y programa <code>MAIN</code></p> <p></p> </li> </ol> </li> <li> <p><code>Instance</code>. Aqu\u00ed aparecer\u00e1n las variables en las im\u00e1genes de Entrada y Salida.</p> </li> </ol> </li> <li> <p>A partir de aqu\u00ed se puede empezar a implementar el proyecto.</p> </li> </ol>"},{"location":"contenidos/01_conceptos/01_tc3_crear_soluciones/#crear-bloque-funcional","title":"Crear bloque funcional","text":"<ol> <li>Hacer CD sobre la secci\u00f3n <code>POUs</code>.</li> <li>Seleccionar <code>Add \u2192 POU \u2192 Functional Block</code>.</li> <li>Darle un nombre significativo.</li> <li>Seleccionar el lenguaje a utilizar. Normalmente utilizaremos <code>ST</code> o <code>SFC</code>.</li> </ol>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/","title":"02 tc3 declarar variables","text":""},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#declaracion-de-variables","title":"\ud83c\udff7\ufe0f Declaraci\u00f3n de variables","text":"<p>Recomendaci\u00f3n</p> <p>Se recomienda utilizar la convenci\u00f3n CamelCase para declarar las variables.</p> <p>Como convenci\u00f3n adicional, a\u00f1adiremos un prefijo <code>i_</code> para aquellas variables que se declaren en la zona de entrada y <code>o_</code> para las de la zona de salida.</p> <ul> <li>Independientemente del lenguaje utilizado para implementar el c\u00f3digo, las variables se declaran de la misma manera.</li> <li>Las variables se declaran en la caja superior de la ventana del bloque funcional creado.</li> <li>La sintaxis para la declaraci\u00f3n de variables es la siguiente:</li> </ul> <pre><code>&lt;NombreVariable&gt; : &lt;tipo&gt; [:=&lt;ValorInicial&gt;]\n</code></pre> <p>Ejemplo</p> <pre><code>// bool\nPulsador: BOOL;\nLuzAmarilla: BOOL := TRUE;\n\n// enteros con y sin signo\nAltura: INT;\nContador: UINT;\nUnidadesSolicitadas: UINT := 10;\n\n// n\u00fameros reales\nTpoSegundos: FLOAT := 1.2;\n\n// tiempo\nTiempoEspera: TIME := T#2s;\nTiempoRestante: TIME;\n\n// bloques funcionales\nFlanco_Pulsador: R_TRIG; // detector de flanco (est\u00e1ndar)\nCoordinador: FB_Coordinador; // bloque funcional definido por el usuario\n\n// arrays\nOcupado: ARRAY[0..3] OF BOOL; // array de cuatro elementos de tipo BOOL; acceso con []\n</code></pre> <ul> <li> <p>La sintaxis de los valores posibles es la siguiente:</p> <ul> <li>Variables booleanas: <code>TRUE</code>, <code>FALSE</code>.</li> <li>Variables enteras: <code>0</code>, <code>1</code>, etc.</li> <li>Variables reales: <code>0.1</code>, <code>2.3</code>, etc.</li> <li> <p>Variables de tiempo: <code>T#&lt;tiempo&gt;</code> donde <code>&lt;tiempo&gt;</code> debe ser del estilo <code>&lt;numero&gt;&lt;unidad&gt;</code>, siendo <code>&lt;unidad&gt;</code> escogido de <code>{s, ms}</code>.</p> <p>Ejemplo</p> <p><code>T#2s</code> (dos segundos)</p> <p><code>T#500ms</code> (quinientos milisegundos).</p> </li> <li> <p>El acceso a los arrays se hace con el \u00edndice entre corchetes. </p> <p>Ejemplo</p> <p><code>Ocupado[1] := TRUE;</code></p> </li> </ul> </li> <li> <p>Las variables en TC3 se declaran dentro de los \u00e1mbitos existentes en el POU correspondiente: marcas (locales), entrada y salida.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#variables-locales","title":"Variables locales","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR\n    Contador: UINT;\nEND_VAR\n</code></pre> <p>Las variables declaradas aqu\u00ed se pueden utilizar dentro del POU pero no pueden tomar valores de fuera del POU ni se pueden acceder desde fuera del POU.</p>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#variables-de-entrada","title":"Variables de entrada","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR_INPUT\n    TiempoEntrada: TIME;\n    TiempoSalida: TIME := T#2s;\nEND_VAR\n</code></pre> <p>Las variables declaradas aqu\u00ed deben ser especificadas al llamar al FB (a no ser que se les de un valor por defecto).</p> <p>Importante</p> <p>No especificarlas en la llamada produce un error de compilaci\u00f3n.</p>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#variables-de-salida","title":"Variables de salida","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR_OUTPUT\n    LuzAmarilla: BOOL;\n    LuzVerde: BOOL;\nEND_VAR\n</code></pre> <p>Las variables declaradas aqu\u00ed pueden ser accedidas desde fuera del FB (por ejemplo, desde otro FB que llama a este, o desde el programa <code>MAIN</code>).</p> <pre><code>PROGRAM MAIN\nVAR\n    Estacion: FB_Estacion\n    LuzAmarillaEstacion: BOOL;\nEND_VAR\n------------------\nLuzAmarillaEstacion := Estacion.LuzAmarilla; // esto es v\u00e1lido\n</code></pre> <p>Importante</p> <p>Querer acceder a una variable de un FB que no ha sido declarada como salida produce un error de compilaci\u00f3n.</p>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#variables-de-entrada-y-salida","title":"Variables de entrada y salida","text":"<pre><code>FUNCTIONAL_BLOCK FB_Estacion\nVAR_IN_OUT\n    Contador: UINT;\nEND_VAR\n</code></pre> <p>Este \u00e1mbito no aparece por defecto al crear un FB pero puede ser a\u00f1adido simplemente escribiendo la secci\u00f3n <code>VAR_IN_OUT ... END_VAR</code>.</p> <p>Las variables declaradas aqu\u00ed deben tomar un valor como entrada al FB y su valor final tras cada ciclo puede ser accedido desde fuera del FB.</p> <p>Combina las condiciones de los \u00e1mbitos de entrada y salida.</p> <ul> <li>En un programa (ej. <code>MAIN</code>) s\u00f3lo disponemos del \u00e1mbito <code>VAR</code>.</li> <li>En un FB, adem\u00e1s del \u00e1mbito <code>VAR</code>, disponemos de los \u00e1mbitos <code>VAR_INPUT</code> y <code>VAR_OUTPUT</code>.</li> </ul>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#variables-vinculadas-a-la-es","title":"Variables vinculadas a la E/S","text":"<p>Recuerda que la memoria del PLC est\u00e1 estructurada en tres secciones: la imagen de entrada, la imagen de salida y la zona de marcas.</p>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#zona-de-marcas","title":"Zona de marcas","text":"<p>Aqu\u00ed se guardar\u00e1n aquellas variables que son internas al programa y no van a ser vinculadas con terminales de entrada y salida.</p> <p>Las variables declaradas con la siguiente sintaxis se guardan en la zona de marcas:</p> <pre><code>VAR\n    Pulsador: BOOL;\n    Contador: UINT;\n    Lampara: BOOL;\nEND_VAR\n</code></pre>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#imagen-de-entrada","title":"Imagen de entrada","text":"<p>Aqu\u00ed se guardar\u00e1n las variables que queremos vincular a las entradas f\u00edsicas del sistema.</p> <p>Su sintaxis a\u00f1ade <code>AT %I*</code> antes de la definici\u00f3n del tipo:</p> <pre><code>VAR\n    i_Pulsador AT %I*: BOOL;\nEND_VAR\n</code></pre> <p>Importante</p> <p>Recuerda que en nuestro trabajo usaremos la convenci\u00f3n de a\u00f1adir un prefijo <code>i_</code> delante de estas variables.</p>"},{"location":"contenidos/01_conceptos/02_tc3_declarar_variables/#imagen-de-salida","title":"Imagen de salida","text":"<p>Aqu\u00ed se guardar\u00e1n las variables que queremos vincular a las salidas f\u00edsicas del sistema.</p> <p>Su sintaxis a\u00f1ade <code>AT %Q*</code> antes de la definici\u00f3n del tipo:</p> <pre><code>VAR\n    o_Lampara AT %Q*: BOOL;\nEND_VAR\n</code></pre> <p>Importante</p> <p>Recuerda que en nuestro trabajo usaremos la convenci\u00f3n de a\u00f1adir un prefijo <code>o_</code> delante de estas variables.</p> <p>Importante</p> <p>Declarar una variable en la imagen de entrada o salida es independiente de que sean entradas o salidas del bloque funcional.</p> <p>Estas declaraciones son completamente correctas.</p> <pre><code>VAR_INPUT\n    Pulsador AT %I*: BOOL;\n    LamparaAmarilla AT %Q*: BOOL;\n    TiempoEspera: TIME;\nEND_VAR\n\nVAR\n    LamparaMarcha AT %Q*: BOOL;\nEND_VAR\n\nVAR_OUTPUT\n    PresenciaPale AT %I*: BOOL;\nEND_VAR\n</code></pre>"},{"location":"contenidos/01_conceptos/03_tc3_crear_duts/","title":"03 tc3 crear duts","text":""},{"location":"contenidos/01_conceptos/03_tc3_crear_duts/#creacion-de-duts","title":"\ud83d\udc6b Creaci\u00f3n de DUTs","text":"<p>Adem\u00e1s de los tipos de datos simples (<code>BOOL</code>, <code>INT</code>, etc.) y los bloques funcionales ya existentes (<code>R_TRIG</code>) o creados por nosotros (<code>FB_Coordinador_ST</code>), en ocasiones podemos necesitar crear tipos de dato que est\u00e1n compuestos por otros tipos de dato. A estos tipos de datos se les denomina tipos de unidad de datos (Data Unit Type, DUT).</p> <p>En nuestros proyectos vamos a poder hacer uso de dos de ellos: </p> <ul> <li>Estructuras (<code>STRUCT</code>)</li> <li>Enumeraciones (<code>ENUM</code>).</li> </ul>"},{"location":"contenidos/01_conceptos/03_tc3_crear_duts/#estructuras","title":"Estructuras","text":"<p>Aglutinan en su interior otros tipos de dato y se definen haciendo CD sobre la carpeta DUTs y escogiendo <code>Add \u2192 DUT</code>:</p> <p></p> <p>Se le da un nombre significativo (se recomienda comenzar con <code>ST</code> como, por ejemplo, <code>ST_PIEZA</code>), se deja marcado Structure y se pulsa en Open.</p> <p>Se abrir\u00e1 una ventana de texto para definir los componentes del tipo de dato:</p> <pre><code>TYPE ST_PIEZA :\nSTRUCT\n    Blanca: BOOL;\n    Baja: BOOL;\n    Tamano: INT;\n    Tiempo: TIME;\nEND_STRUCT\nEND_TYPE\n</code></pre> <p>Para usarlo, se define una variable de ese tipo y se accede a sus componentes mediante el operador <code>.</code> (punto):</p> <pre><code>// Definicion de variables\nVAR\n    Pieza: ST_PIEZA;\n    Baja: BOOL;\nEND_VAR\n--------------------------------\n// Implementacion\nPieza.Blanca := TRUE;\nBaja := (Pieza.Tamano &lt; 12);\nPieza.Tiempo := T#1s;\n</code></pre>"},{"location":"contenidos/01_conceptos/03_tc3_crear_duts/#enumeraciones","title":"Enumeraciones","text":"<p>Una enumeraci\u00f3n (<code>ENUM</code>) es un tipo de datos definido por el usuario compuesto por una serie de componentes separados por comas, tambi\u00e9n llamados valores de enumeraci\u00f3n, que se utiliza para declarar variables definidas por el usuario.</p> <p>Se definen haciendo CD sobre la carpeta DUTs y escogiendo <code>Add \u2192 DUT</code>:</p> <p></p> <p>Se le da un nombre significativo (se recomienda comenzar con <code>E</code> como, por ejemplo,  <code>E_ColorBasic</code>), se deja marcado Enumeration y se pulsa en Open.</p> <p>Se abrir\u00e1 una ventana de texto para definir los componentes del tipo de dato:</p> <pre><code>{attribute 'qualified_only'}\n{attribute 'strict'}\nTYPE E_ColorBasic :\n(\n    eRed, \n    eYellow,\n    eGreen,\n    eBlue,\n    eBlack\n) // Basic data type is INT, default initialization is eRed\n;\nEND_TYPE\n</code></pre> <p>Una variable definida con el tipo <code>E_ColorBasic</code> es, en realidad, de tipo <code>INT</code> y solo puede tomar los valores definidos en <code>E_ColorBasic</code>: <code>eRed</code>, <code>eYellow</code>, etc.</p> <p>Cada uno de esos valores tiene un valor <code>INT</code> asociado, comenzando por el cero: <code>eRed = 0</code>, <code>eYellow = 1</code>, etc.</p> <p>Para usarlo, se define una variable de ese tipo y se le asigna el valor deseado usando el nombre del tipo de dato Enumeration:</p> <pre><code>// Definicion de variables\nVAR\n    Color: E_ColorBasic;\nEND_VAR\n--------------------------------\n// Implementacion\nColor := E_ColorBasic.eYellow; // asignacion de valor\nIF Color &lt;&gt; E_ColorBasic.eRed THEN // comprobacion de valor\n    [...]\nEND_IF\n</code></pre>"},{"location":"contenidos/01_conceptos/04_tc3_lenguaje_st/","title":"04 tc3 lenguaje st","text":""},{"location":"contenidos/01_conceptos/04_tc3_lenguaje_st/#lenguaje-st","title":"\ud83d\udcc4 Lenguaje ST","text":"<p>Recomendaci\u00f3n</p> <p>Es recomendable acceder a la ayuda y documentaci\u00f3n del lenguaje ST (Structured Text) que ofrece Beckhoff en su portal Infosys.</p>"},{"location":"contenidos/01_conceptos/04_tc3_lenguaje_st/#sintaxis-general","title":"Sintaxis general","text":"<ul> <li>Las instrucciones deben terminar con <code>;</code>.</li> <li>Los comentarios se pueden realizar con <code>//</code> hasta final de l\u00ednea o metiendo el texto entre <code>(*</code> y <code>*)</code>.</li> <li>La asignaci\u00f3n de valores entre variables se realiza con el operador <code>:=</code>.</li> <li>La comparaci\u00f3n de valores se realiza con los operadores <code>=</code>, <code>&lt;&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>.</li> <li>Las operaciones l\u00f3gicas se realizan con los operadores <code>AND</code>, <code>OR</code> y <code>NOT</code>.</li> <li>La llamada a los FBs se realiza escribiendo el nombre de la instancia del FB seguido de, entre par\u00e9ntesis, las asignaciones de los valores para las variables de entrada (si las hay), separadas por comas: <code>&lt;nombre_instancia&gt;(var1:=val1, var2:=val2, ...);</code></li> <li> <p>En caso de que no haya ninguna variable de entrada que especificar, simplemente se abre y se cierra par\u00e9ntesis.</p> <p>Ejemplo</p> <p><code>Estacion();</code></p> <p><code>Lampara(TiempoEncedido:=T#2s);</code></p> </li> </ul>"},{"location":"contenidos/01_conceptos/04_tc3_lenguaje_st/#estructuras-de-control","title":"Estructuras de control","text":"<ul> <li>Las estructuras de control b\u00e1sicas son:<ul> <li>Condicionales (<code>if</code>, <code>case</code>)     <pre><code>IF &lt;condition&gt; THEN\n    &lt;statements&gt;\nELSIF &lt;condition&gt; THEN\n    &lt;statements&gt;\nELSE\n    &lt;statements&gt;\nEND_IF;\n\nCASE &lt;expression&gt; OF\n    &lt;value&gt;, &lt;value&gt;, \u2026, &lt;value&gt;: &lt;statements&gt;\nELSE\n    &lt;statements&gt;\nEND_CASE;\n</code></pre></li> <li>Bucles (<code>for</code>, <code>while</code>, <code>repeat</code>)     <pre><code>FOR &lt;variable&gt; := &lt;expression&gt; TO &lt;expression&gt; BY &lt;expression&gt; DO\n    &lt;statements&gt;\nEND_FOR;\n\nWHILE &lt;condition&gt; DO\n    &lt;statements&gt;\nEND_WHILE;\n\nREPEAT\n    &lt;statement&gt;\nUNTIL &lt;condition&gt;\nEND_REPEAT;\n</code></pre></li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/","title":"05 tc3 lenguaje sfc","text":""},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/#lenguaje-sfc","title":"\u2935\ufe0f Lenguaje SFC","text":""},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/#reglas-sintacticas","title":"Reglas sint\u00e1cticas","text":"<ul> <li>Los nombres de las etapas en SFC (Sequential Function Chart) no pueden empezar por un n\u00famero. Tampoco pueden tener espacios, puntos u otros caracteres especiales como e\u00f1es, interrogaciones, etc. S\u00ed permite guiones bajos.</li> <li>No puede haber dos etapas consecutivas ni dos transiciones consecutivas. Hay que tener especial atenci\u00f3n a esto cuando se produzcan bifurcaciones o saltos.</li> </ul>"},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/#anadir-etapa-transicion","title":"A\u00f1adir etapa / transici\u00f3n","text":"<ul> <li>Hacer CD sobre la etapa donde queramos introducir una nueva y seleccionar Add step-transition o Add step-transition after, dependiendo de si queremos a\u00f1adirla antes o despu\u00e9s, respectivamente, de la etapa seleccionada.</li> </ul> <p>Importante</p> <p>Comprobar que no quedan dos etapas o dos transiciones consecutivas. En caso contrario, borrar aquello que no sirva (CI sobre \u00e9l y pulsar Supr).</p>"},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/#asociar-acciones-a-etapas","title":"Asociar acciones a etapas","text":""},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/#accion-continua","title":"Acci\u00f3n continua","text":"<ul> <li>Hacer CD sobre la etapa a la que queramos asociar una acci\u00f3n no memoriza (o continua) y seleccionar Insert action association o Insert action association after, dependiendo de si queremos insertarla antes o despu\u00e9s de las ya existentes (si las hay).</li> <li> <p>En la caja de la acci\u00f3n aparece en primer lugar el modificador (por defecto <code>N</code>, que significa \"No memorizada\") y en segundo lugar el hueco donde debemos poner la acci\u00f3n a realizar (una variable booleana que queramos activar o una acci\u00f3n m\u00e1s compleja definida como acci\u00f3n asociada al bloque funcional).</p> <p></p> <ul> <li> <p>Tipos de modificadores de acciones</p> C\u00f3digo Tipo Descripci\u00f3n <code>N</code> No memorizada (continua) Se ejecuta/activa mientras la etapa est\u00e9 activa. <code>R0</code> Reinicio La acci\u00f3n se desactiva. <code>S0</code> Activaci\u00f3n Se ejecuta cuando se activa la etapa y contin\u00faa activa aunque la etapa se desactive. <code>L</code> Limitada Se ejecuta cuando se activa la etapa y se desactiva cuando la etapa se desactiva o se alcanza el tiempo especificado. <code>D</code> Retrasada Se ejecuta un tiempo despu\u00e9s de que se active la etapa y se desactiva cuando la etapa se desactiva. <code>P</code> Pulsada Se ejecuta dos veces: cuando se activa la etapa y una vez m\u00e1s en el ciclo siguiente. <code>SD</code> Activaci\u00f3n con retardo Se activa aunque la etapa ya no est\u00e9 activa. <code>DS</code> Retardo de activaci\u00f3n Se activa solo si la etapa permanece activa. <code>SL</code> Activaci\u00f3n limitada Activaci\u00f3n con duraci\u00f3n limitada. <p>Importante</p> <p>Usaremos, por defecto, las acciones no memorizadas, aunque se pueden usar las otras si tiene sentido para el proyecto.</p> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/#accion-de-entrada-o-salida","title":"Acci\u00f3n de entrada o salida","text":"<ul> <li>Podemos crear acciones con activaci\u00f3n a la entrada o a la salida de una etapa.</li> <li> <p>Estas acciones se implementan en alguno de los lenguajes de la norma y permiten realizar acciones que se ejecutan solo una vez durante la etapa, en lugar de hacerse de manera continua.</p> <ul> <li> <p>A la entrada</p> <ul> <li>Las acciones con activaci\u00f3n a la entrada se ejecutan solo una vez inmediatamente despu\u00e9s de entrar en la etapa donde se asocian. Posteriormente se comprueba si la condici\u00f3n de transici\u00f3n para pasar a la siguiente etapa es cierta o no.</li> <li>Normalmente usaremos estas acciones para inicializar variables memorizadas, actualizar contadores, etc.</li> <li>Para crear una de este tipo, hacer CD sobre la etapa donde la queremos asociar y seleccionar Add entry action.</li> <li> <p>Aparece un popup donde se nos pregunta por el nombre que le queremos poner y el lenguaje a utilizar. Se recomienda dejar el nombre por defecto (<code>S0_entry</code> en la figura) ya que nos indica en qu\u00e9 etapa est\u00e1 y de qu\u00e9 tipo es.</p> <p></p> </li> <li> <p>En nuestros proyectos, estas acciones siempre ser\u00e1n en <code>ST</code>, pero podr\u00edan ser implementadas en cualquier otro lenguaje de la norma.</p> </li> <li> <p>Una vez creada, aparece en el programa <code>SFC</code> como un cuadrado con una E en la esquina inferior izquierda de la etapa.</p> <p></p> </li> </ul> </li> <li> <p>A la salida</p> <ul> <li>Las acciones con activaci\u00f3n a la salida se ejecutan solo una vez inmediatamente antes de pasar a la siguiente etapa. Esto implica que antes de que se ejecute esta acci\u00f3n, la condici\u00f3n de transici\u00f3n para pasar a la siguiente etapa debe ser cierta.</li> <li>Normalmente usaremos estas acciones para inicializar variables memorizadas, actualizar contadores, etc.</li> <li>Para crear una de este tipo, hacer CD sobre la etapa donde la queremos asociar y seleccionar Add exit action.</li> <li> <p>Aparece un popup donde se nos pregunta por el nombre que le queremos poner y el lenguaje a utilizar. Se recomienda dejar el nombre por defecto (<code>S0_exit</code> en la figura) ya que nos indica en qu\u00e9 etapa est\u00e1 y de qu\u00e9 tipo es.</p> <p></p> </li> <li> <p>En nuestros proyectos, estas acciones siempre ser\u00e1n en <code>ST</code>, pero podr\u00edan ser implementadas en cualquier otro lenguaje de la norma.</p> </li> <li> <p>Una vez creada, aparece en el programa <code>SFC</code> como un cuadrado con una X en la esquina inferior derecha de la etapa.        </p> <p>Importante</p> <p>Nada impide que una etapa tenga asociadas una o varias acciones no memorizadas, una con activaci\u00f3n a la entrada y otra con activaci\u00f3n a la salida.</p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/05_tc3_lenguaje_sfc/#accion-principal-todo","title":"Acci\u00f3n principal (TODO)","text":""},{"location":"contenidos/01_conceptos/06_tc3_estructuras_evolucion/","title":"06 tc3 estructuras evolucion","text":""},{"location":"contenidos/01_conceptos/06_tc3_estructuras_evolucion/#estructuras-de-evolucion","title":"\ud83d\udd00 Estructuras de evoluci\u00f3n","text":""},{"location":"contenidos/01_conceptos/06_tc3_estructuras_evolucion/#secuencia-basica","title":"Secuencia b\u00e1sica","text":"<ul> <li> <p>Una secuencia b\u00e1sica se compone de una sucesi\u00f3n lineal de etapas y transiciones, donde las primeras se van a ir ejecutando en secuencia conforme las condiciones asociadas a las segundas se vayan cumpliendo.</p> </li> <li> <p>Normalmente, al final de la secuencia se producir\u00e1 un salto hacia atr\u00e1s (o el inicio) en el programa.</p> <p></p> </li> <li> <p>Para insertar un salto detr\u00e1s de una transici\u00f3n, hay que hacer CD sobre la transici\u00f3n y seleccionar Insert jump after. Solo hay que indicar el nombre de la etapa a la que queremos saltar.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/06_tc3_estructuras_evolucion/#bifurcacion","title":"Bifurcaci\u00f3n","text":"<ul> <li> <p>Tras una etapa podemos realizar una bifurcaci\u00f3n en distintas ramas en funci\u00f3n de distintas condiciones. Esto nos permite dirigir la secuencia por cambio si ocurre un evento y por otros distintos si ocurren otros eventos.</p> </li> <li> <p>En el ejemplo de la figura, si la etapa <code>Init</code> est\u00e1 activa y se activa <code>Execute</code>, el programa evolucionar\u00e1 por la rama de la izquierda llegando a <code>S0</code>. Si lo que se activa es <code>Restore</code>, el programa evolucionar\u00e1 por la derecha pasando a <code>Sr</code> y, una vez se active <code>Restaurado</code>, la secuencia pasar\u00e1 a <code>S0</code>.</p> <p></p> </li> <li> <p>Para realizar una bifurcaci\u00f3n, hacer CD sobre la transici\u00f3n donde se quiera hacer la bifurcaci\u00f3n (<code>Execute</code> en el ejemplo) y seleccionar Insert branch right.</p> </li> <li> <p>Nada impide que se pueda hacer una bifurcaci\u00f3n con m\u00e1s de dos ramas.</p> </li> <li> <p>Es recomendable que las condiciones de la bifurcaci\u00f3n sean excluyentes pero nada impide que no lo sean. El programa tomar\u00e1 el camino de la primera transici\u00f3n cuya condici\u00f3n sea verdadera.</p> </li> <li> <p>Si ocurriera que varias o todas las condiciones son verdaderas a la vez, el programa evolucionar\u00e1 por la rama de la izquierda. Aunque esto puede ser \u00fatil en algunos casos, esto suele indicar que hay un mal dise\u00f1o en el programa.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/06_tc3_estructuras_evolucion/#paralelismo","title":"Paralelismo","text":"<ul> <li> <p>Si queremos que el programa evolucione por dos secuencias en paralelo (se ejecutan simult\u00e1neamente) podemos incluir un paralelismo en el c\u00f3digo.</p> </li> <li> <p>En el ejemplo de la figura, si la etapa <code>Init</code> est\u00e1 activa y se activa <code>Execute</code>, el programa evolucionar\u00e1 por ambas ramas a la vez, activando los estados <code>S0</code> y <code>Sr</code> de manera simult\u00e1nea (y por tanto, <code>LuzRoja</code> y <code>Restaura</code>).</p> <p></p> </li> <li> <p>En la transici\u00f3n con condici\u00f3n <code>NOT Pulsador OR S0.t&gt;T#5s</code> se produce un punto de sincronizaci\u00f3n ya que, para que el programa evolucione a <code>S1</code> debe ocurrir que <code>S0</code> y <code>Sr2</code> est\u00e9n activas y, adem\u00e1s, que la condici\u00f3n <code>NOT Pulsador OR S0.t&gt;T#5s</code> sea cierta. Por tanto, podemos decir que el programa esperar\u00e1 hasta que termine la rama de la derecha antes de evolucionar.</p> </li> </ul>"},{"location":"contenidos/01_conceptos/07_tc3_crear_visualizacion/","title":"07 tc3 crear visualizacion","text":""},{"location":"contenidos/01_conceptos/07_tc3_crear_visualizacion/#crear-visualizacion","title":"\ud83d\udda5\ufe0f Crear visualizaci\u00f3n","text":"<ul> <li> <p>Hacer CD sobre la secci\u00f3n <code>VISUs</code>.</p> </li> <li> <p>Seleccionar <code>Add \u2192 Visualization</code> y pulsar en Open en la ventana popup.</p> <p></p> </li> <li> <p>En la parte derecha de la pantalla aparecer\u00e1 la secci\u00f3n <code>Toolbox</code> donde, en la secci\u00f3n <code>Basic</code> aparecen las formas b\u00e1sicas. Arrastrar a la visualizaci\u00f3n los elementos que se quieran.</p> </li> </ul> <p>Importante</p> <p>Si no aparece la secci\u00f3n, mostrarlo entrando en el Men\u00fa <code>View \u2192 Toolbox</code></p> <p>Recomendaci\u00f3n</p> <p>Se recomienda utilizar rect\u00e1ngulos para crear botones tanto para las entradas como para las salidas.</p>"},{"location":"contenidos/01_conceptos/07_tc3_crear_visualizacion/#botones-para-cambiar-valores-de-variables","title":"Botones para cambiar valores de variables","text":"<ul> <li> <p>Dibujar un rect\u00e1ngulo con el tama\u00f1o deseado.</p> </li> <li> <p>Escribir dentro la etiqueta que queramos que aparezca en el bot\u00f3n.</p> </li> <li> <p>Introducir la variable de tipo <code>BOOL</code> que queremos asociar a dicho bot\u00f3n. Dependiendo del comportamiento que queramos que tenga el bot\u00f3n, esta variable se introduce en una secci\u00f3n distinta dentro de <code>Properties \u2192 Input Configuration</code> (la pesta\u00f1a <code>Properties</code> aparece a la derecha, normalmente combinada con <code>Toolbox</code>).</p> <ul> <li> <p>Si queremos que la variable cambie de valor mientras se pulsa el bot\u00f3n con el rat\u00f3n pero vuelva a su valor anterior una vez soltado el rat\u00f3n, introduciremos la variable en la secci\u00f3n <code>Tap</code>:</p> <p></p> </li> <li> <p>Si queremos que la variable cambie de valor cada vez que pulsemos el bot\u00f3n (el valor conmutar\u00e1 entre <code>TRUE</code> y <code>FALSE</code>) lo introduciremos en la secci\u00f3n <code>Toggle</code>:</p> <p></p> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/08_tc3_importar_exportar/","title":"08 tc3 importar exportar","text":""},{"location":"contenidos/01_conceptos/08_tc3_importar_exportar/#exportar-e-importar","title":"\ud83d\udd04 Exportar e importar","text":"<ol> <li>Podemos exportar <code>POUs</code> y <code>VISUs</code> desde una soluci\u00f3n de TC3 e importarla de nuevo en otra distinta. De esta manera podemos reutilizar c\u00f3digo de distintas proyectos.</li> <li>Para realizar esto, en la soluci\u00f3n origen, simplemente hay que hacer CD sobre el <code>POU</code> o <code>VISU</code> a exportar y seleccionar Export to ZIP. Se selecciona donde guardar el archivo exportado y se pulsa Save.</li> <li>Posteriormente, en la soluci\u00f3n destino, hacer CD sobre la carpeta <code>POU</code> o <code>VISU</code> y seleccionar Import from ZIP. Se busca el archivo correspondiente y se pulsa OK.</li> </ol>"},{"location":"contenidos/01_conceptos/09_tc3_guardar_mover/","title":"09 tc3 guardar mover","text":""},{"location":"contenidos/01_conceptos/09_tc3_guardar_mover/#guardar-y-mover-proyectos","title":"\ud83d\udcbe Guardar y mover proyectos","text":"<p>Importante</p> <p>Se ha detectado que el sincronizar la carpeta del proyecto usando servicios como Google Drive est\u00e1 produciendo problemas a la hora de poder abrir los proyectos. Posiblemente esto se deba a que algunos ficheros no son sincronizados correctamente por Drive (por motivos desconocidos), lo que lleva a que, a la hora de abrir el proyecto, no se carguen los ficheros necesarios. </p> <p>Se recomienda, por tanto, no usar este m\u00e9todo sino alguno de los otros.</p>"},{"location":"contenidos/01_conceptos/09_tc3_guardar_mover/#usando-la-carpeta-completa","title":"Usando la carpeta completa","text":"<ol> <li>Es la manera m\u00e1s sencilla de llevarse un proyecto desde un equipo a otro.</li> <li> <p>Solo hay que copiar la carpeta ra\u00edz en un pendrive y pegar la carpeta en el equipo destino.</p> <p></p> </li> <li> <p>Posteriormente, hacer DCI sobre el fichero de Solution (<code>.sln</code>) para que se abra de nuevo en TC3.</p> </li> </ol> <p>Importante</p> <p>Si la carpeta ha sido comprimida para ser trasladada, hay que asegurarse de haber descomprimido la carpeta completa en el destino antes de abrir el proyecto.</p>"},{"location":"contenidos/01_conceptos/09_tc3_guardar_mover/#exportando-como-tnzip","title":"Exportando como <code>.tnzip</code>","text":"<p>Importante</p> <p>La entrega final del proyecto deber\u00e1 seguir este procedimiento.</p> <ol> <li>Este proceso genera el m\u00ednimo tama\u00f1o posible para trasladar un proyecto.</li> <li>Seleccionar <code>File \u2192 Save [nombre_del_proyecto] as Archive...</code>.</li> <li>Seleccionar d\u00f3nde guardar el proyecto, darle un nombre y asegurarse de que el formato es de tipo <code>.tnzip</code>.</li> <li>Para volver a abrir el proyecto:</li> <li>Abrir TC3.</li> <li>Seleccionar <code>File \u2192 Open \u2192 Solution from Archive...</code>.</li> <li>Buscar el archivo <code>.tnzip</code>.</li> <li>Seleccionar (o crear si no existe) una carpeta donde se va a generar la Solution.</li> <li>En principio, se puede seleccionar siempre la misma carpeta cada vez que se repita este procedimiento.</li> </ol> <p>Importante</p> <p>Si al abrir el proyecto de nuevo y compilar obtienes errores no relacionados con el c\u00f3digo que antes no ten\u00edas:</p> <ul> <li>Cambiar el tipo de proyecto a TwinCAT RT (x86)</li> <li>Recompilar</li> <li>Volver a cambiar a TwinCAT RT (x64)</li> <li>Volver a recompilar</li> </ul>"},{"location":"contenidos/01_conceptos/09_tc3_guardar_mover/#usando-git","title":"Usando GIT","text":"<p>TwinCAT3, al estar basado en Visual Studio, tiene compatibilidad directa con GitHub.  Se recomienda seguir el tutorial en este video:</p> <p>PLC Programming using TwinCAT 3 - Version control</p>"},{"location":"contenidos/01_conceptos/10_tc3_convenciones/","title":"10 tc3 convenciones","text":""},{"location":"contenidos/01_conceptos/10_tc3_convenciones/#convenciones-de-nombres","title":"\ud83d\udcdd Convenciones de nombres","text":"<p>Se recomienda llamar a todos los elementos del proyecto con el nombre adecuado desde el principio, ya que renombrar a posteriori puede acarrear problemas derivados del acceso a elementos cuya ruta ha cambiado. No obstante, si es necesario renombrar los elementos, el procedimiento es como sigue.</p>"},{"location":"contenidos/01_conceptos/10_tc3_convenciones/#soluciones","title":"Soluciones","text":"<p>Se recomienda llamar a las soluciones de TC3 de la misma forma que los Proyectos de TC3.</p> <p>Para renombrarlo una vez creado:</p> <ol> <li> <p>CD sobre el nombre de la soluci\u00f3n y seleccionar Rename.</p> <p></p> </li> <li> <p>Escribir el nuevo nombre.</p> </li> </ol>"},{"location":"contenidos/01_conceptos/10_tc3_convenciones/#proyectos-twincat3","title":"Proyectos TwinCAT3","text":"<ul> <li> <p>Se recomienda llamar a los proyectos TC3 de la siguiente forma:</p> <ul> <li> <p>Para los ejemplos: <code>TC3_[nombre]</code>   donde el nombre debe ser algo significativo.</p> <p>Ejemplo</p> <p><code>TC3_Lampara</code></p> <p><code>TC3_Carro</code></p> </li> <li> <p>Para los trabajos finales: <code>[codigo]_TC3_G[grupo]</code>   donde <code>codigo</code> debe escogerse seg\u00fan la asignatura (<code>AIM</code>, <code>AIE</code>, <code>SR</code>, etc.) y <code>grupo</code> debe ser el n\u00famero del grupo con dos d\u00edgitos (<code>01</code>, <code>02</code>, ...).</p> <p>Ejemplo</p> <p><code>AIM_TC3_G01</code></p> <p><code>SR_TC3_G12</code></p> </li> <li> <p>C\u00f3digos de las asignaturas:</p> C\u00f3digo Asignatura AIM Automatizaci\u00f3n Industrial de GIERM AIE Automatizaci\u00f3n Industrial de GIEI o GIEI+IEL SR Sistemas Robotizados de GITI </li> <li> <p>Para renombrarlo una vez creado:</p> <ul> <li> <p>CD sobre el nombre del proyecto TC3 y seleccionar Rename.</p> <p></p> </li> <li> <p>Escribir el nuevo nombre.</p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"contenidos/01_conceptos/10_tc3_convenciones/#proyectos-plc","title":"Proyectos PLC","text":"<ul> <li> <p>Se recomienda llamar a los proyectos PLC de la forma <code>[nombre]_PLC</code> para los ejemplos o <code>[estacion]_[nivel]_PLC</code> para los trabajos, donde el nombre debe ser algo significativo.</p> <p>Ejemplo</p> <p><code>Lampara_PLC</code></p> <p><code>FMS201_Monolitico_PLC</code></p> </li> <li> <p>Para renombrarlo una vez creado:</p> <ol> <li> <p>CD sobre el nombre del proyecto PLC y seleccionar Rename.</p> <p></p> </li> <li> <p>Escribir el nuevo nombre.</p> </li> <li> <p>Aparecer\u00e1 un aviso indicando que si se cambia el nombre del proyecto no se van a poder hacer cambios online (en caso de que se est\u00e9 ejecutando). CI en S\u00ed.</p> <p></p> </li> <li> <p>Tras unos segundos, el proyecto PLC habr\u00e1 cambiado de nombre.</p> </li> <li>Importante: Puede ocurrir que, tras el cambio de nombre, al hacer CI sobre el proyecto, salga un aviso de error por no encontrar el nombre anterior. Esto se debe solucionar haciendo CI sobre <code>Build \u2192 Rebuild Solution</code>.</li> </ol> </li> </ul>"},{"location":"contenidos/01_conceptos/10_tc3_convenciones/#bloques-funcionales","title":"Bloques Funcionales","text":"<ul> <li>Se recomienda llamar a los bloques funcionales de la forma <code>FB_[nombre]_[lenguaje]</code>, donde el nombre debe ser algo significativo.</li> <li> <p>Los lenguajes suelen ser:</p> <ul> <li><code>ST</code> (Structured Text)</li> <li><code>SFC</code> (Sequential Function Chart)</li> </ul> <p>Ejemplo</p> <p><code>FB_Estacion_ST</code></p> <p><code>FB_Coordinador_ST</code></p> <p><code>FB_Alimentador_SFC</code></p> </li> <li> <p>Para renombrarlo una vez creado:</p> <ol> <li>CD sobre el nombre del FB y seleccionar Rename.</li> <li>Escribir el nuevo nombre.</li> <li> <p>Aparecer\u00e1 un aviso indicando que se van a adaptar todas las referencias en el proyecto. Pulsar en Yes.</p> <p></p> </li> <li> <p>Aparecer\u00e1 una ventana mostrando todos los cambios que se van a realizar. Pulsar en OK.</p> <p></p> </li> </ol> </li> </ul>"},{"location":"contenidos/01_conceptos/10_tc3_convenciones/#variables","title":"Variables","text":"<ul> <li>Se recomienda llamar a las variables con nombres significativos.</li> <li>Si las variables se van a asociar con los terminales de entrada y salida, es obligatorio llamarlas con el nombre indicado en la columna Variable de la tabla de E/S.</li> <li>Para renombrar una variable y que ese cambio se corrija en todas las referencias que se hagan a la misma en el proyecto, hay que hacer CD sobre el nombre de la variable y seleccionar <code>Refactoring \u2192 Rename</code>.</li> <li> <p>Aparecer\u00e1 un popup donde se debe indicar el nuevo nombre.</p> <p></p> </li> <li> <p>Aparecer\u00e1 una ventana mostrando todos los cambios que se van a realizar. Pulsar en OK.</p> <p></p> </li> </ul>"},{"location":"contenidos/01_conceptos/11_tc3_ejecutar_programa/","title":"11 tc3 ejecutar programa","text":""},{"location":"contenidos/01_conceptos/11_tc3_ejecutar_programa/#ejecutar-programa","title":"\u25b6\ufe0f Ejecutar programa","text":"<p>Una vez el programa est\u00e1 implementado (independientemente del lenguaje utilizado):</p> <ul> <li>Compilar el proyecto: Men\u00fa <code>Build \u2192 Build [nombre del proyecto]</code>.</li> <li>Asegurarse de que no hay errores.</li> <li> <p>Si has declarado variables en las im\u00e1genes de entrada y/o salida:     </p> <ul> <li> <p>Comprobar que las variables aparecen en la zona de la instancia.</p> <p></p> </li> </ul> </li> <li> <p>Si quieres utilizar el Equipo Remoto:</p> <ul> <li>Vincular las variables con los terminales correspondientes seg\u00fan la tabla de E/S:<ul> <li>DCI sobre la variable a vincular.</li> <li>Seleccionar el terminal/canal deseado del listado que aparece.</li> </ul> </li> <li>Buscar el equipo remoto.</li> </ul> </li> <li> <p>Si quieres usar el Runtime local</p> <ul> <li> <p>Asegurarte de que seleccionar <code>`Local</code> en el desplegable del <code>Target</code>. </p> <p></p> </li> </ul> </li> <li> <p>Activar la configuraci\u00f3n en el <code>Target</code> (Activate Configuration) y activar el modo de ejecuci\u00f3n (Run Mode). Esto \u00faltimo te lo pregunta TwinCAT3 en una ventana popup.</p> <p></p> </li> <li> <p>Descargar el programa en el <code>Target</code> (Login), donde se preguntar\u00e1, en un popup, si quieres crear un puerto de comunicaci\u00f3n con el <code>Target</code> y descargar el programa. Pulsar en Yes.</p> <p></p> </li> <li> <p>Ejecutar el programa (Start).</p> <p></p> </li> </ul> <p>Importante</p> <p>Para poder modificar de nuevo el programa, primero hay que parar el programa (Stop) [recomendado] y posteriormente hacer Logout.</p> <p></p>"},{"location":"contenidos/01_conceptos/12_tc3_activar_hw/","title":"12 tc3 activar hw","text":""},{"location":"contenidos/01_conceptos/12_tc3_activar_hw/#activardesactivar-hardware","title":"\ud83d\udd0c Activar/desactivar hardware","text":"<ol> <li>Si has vinculado las variables de tu programa con el equipo remoto (hiciste la b\u00fasqueda del equipo remoto y la exploraci\u00f3n de los m\u00f3dulos de E/S), cuando quieras probar tu programa en el Runtime Local, aparecer\u00e1 una ventana popup indicando un error.</li> <li>Esto se debe a que TC3 quiere establecer conexi\u00f3n con el hardware al que estuviste conectado pero no puede, ya que el <code>Target</code> es el local.</li> <li>Para evitar esto, solo tienes que deshabilitar el hardware haciendo CD sobre el dispositivo buscado y seleccionar Disable.</li> </ol> <p>Importante</p> <p>Recuerda volver a habilitarlo cuando quieras volver a usar el equipo remoto.</p>"},{"location":"contenidos/01_conceptos/13_tc3_busqueda_equipos/","title":"13 tc3 busqueda equipos","text":""},{"location":"contenidos/01_conceptos/13_tc3_busqueda_equipos/#busqueda-de-equipos","title":"\ud83c\udf10 B\u00fasqueda de equipos","text":"<p>Recomendaci\u00f3n</p> <p>Hay un video de ejemplo en el Campus Virtual en <code>Automatizaci\u00f3n &gt; Videos &gt; TC3</code> con nombre <code>9_Runtime_Target_*.mkv</code>.</p>"},{"location":"contenidos/01_conceptos/14_tc3_enlace_es/","title":"14 tc3 enlace es","text":""},{"location":"contenidos/01_conceptos/14_tc3_enlace_es/#enlace-de-variables-y-es","title":"\ud83d\udd17 Enlace de variables y E/S","text":"<p>Recomendaci\u00f3n</p> <p>Hay un video de ejemplo en el Campus Virtual en <code>Automatizaci\u00f3n &gt; Videos &gt; TC3</code> con nombre <code>9_Runtime_Target_*.mkv</code>.</p>"}]}